#include "fp-avx2.h"
#include "../fp-counters.h"
#include "../../primes.h"

#include <gmp.h>
#include <immintrin.h>

uint64_t count_add = 0;
uint64_t count_add_old = 0;
uint64_t count_add_max = 0;

//#define USE_GMP_SEC_FUNCTIONS
//#define MONTGOMERY


#if defined P2047k221

// const fp fp_1 = {0x3, 0x0, 0x0, 0x0, 0x1a4e1f1, 0x22feb15, 0x2db5ac1, 0xf4e42a, 0x886903, 0x2ebc7b9, 0xb7b9fa, 0x2816c5d, 0x1f52a1d, 0x3608754, 0x38b1022, 0x2cf3d38, 0x385d6e0, 0x1f6d746, 0x19c2f4d, 0x36ca57c, 0x3cafb95, 0x1d78654, 0x1b7ee39, 0x3354ad1, 0x28a80c6, 0x23e4ba3, 0xababe, 0x36f4f58, 0x10fe587, 0xf61108, 0x254d8d3, 0x3ec16af, 0x97fe0b, 0x9e9252, 0x18ed04f, 0x1863fd3, 0x2630c95, 0xbb6c1b, 0x180a79f, 0x127f5cc, 0x30aeb3e, 0x7bdeed, 0x5b0608, 0x23c46bd, 0x3e15b2f, 0x368fbd9, 0x24db63, 0x30dce29, 0x34e682, 0xbb8478, 0x2517d4b, 0x183effa, 0x2ac1a9a, 0x2f523ff, 0x3e6b99b, 0x158db2e, 0x3fd93a0, 0x63006e, 0x1945f80, 0x30cf5e3, 0x2f56f27, 0x2dd9dfc, 0x35a3db8, 0xad2f42, 0xf51f7d, 0x20aa007, 0x195c63c, 0x87a89d, 0x28e7259, 0x726a38, 0x2ef0588, 0x3ab88a9, 0x171a2e4, 0x1cc0480, 0x1b08ea6, 0x33505ad, 0x330dd8b, 0x3ca2d47, 0x1222f};

// const fp p = {0x3ffffff, 0x3ffffff, 0x3ffffff, 0x3ffffff, 0xc90a04, 0x3455c4e, 0x30c3714, 0x103b3f1, 0x27d3254, 0x1b16817, 0x26d6cac, 0x7f868b, 0x358f1f6, 0x2dfd2e3, 0x2d1a549, 0x1baeb97, 0x2d3630a, 0xadb83d, 0x3769ae6, 0x311e2b, 0x2bc56ce, 0x20d7de3, 0xc2b097, 0x4391ba, 0x1d1d513, 0x95e6c9, 0x3fc6c6b, 0x1859037, 0xfab37d, 0x258a4fd, 0x1e3b7b9, 0x2b14dc5, 0x27800a6, 0x12079e4, 0x225ba90, 0x37deab9, 0x89a678, 0x26c314c, 0xd51d75, 0xf2ae11, 0x1a706eb, 0x281605b, 0x28c5352, 0x1ebe86b, 0x15f8c45, 0x3256b7, 0x1490c34, 0x2fb65f2, 0x143b329, 0x26c292d, 0x33a2b91, 0x37eb001, 0x31bf721, 0x3039eaa, 0x2b31776, 0x38d0c45, 0x156241f, 0x1345530, 0xce8ad5, 0x1a658b4, 0x303859d, 0x1b620ab, 0x3740c2, 0x270f03f, 0x103a02b, 0x351caa8, 0x378bdeb, 0x1281d20, 0x325d9e2, 0x3d9dc97, 0x5afe27, 0x2c6d272, 0x384c9b3, 0xbbfe7f, 0x36fd073, 0x2ee5370, 0x2efb626, 0x2bc9b92, 0x4f49a};

const uint64_t p64[NUMBER_OF_WORDS] = {0xFFFFFFFFFFFFFFFF, 0xC90A04FFFFFFFFFF, 0xFC70C3714D157138, 0xC5A05E7D325440EC, 0xF61FE1A2E6D6CAC6, 0x1A549B7F4B8F58F1, 0xF6D3630A6EBAE5ED, 0x478AF769AE62B6E0, 0x7835F78EBC56CE0C, 0xD51310E46E8C2B09, 0xFFC6C6B2579B25D1, 0x93F4FAB37D61640D, 0xAC53715E3B7B9962, 0xA90481E7927800A6, 0x89A678DF7AAE625B, 0x844D51D759B0C530, 0x5816DA706EB3CAB, 0x457AFA1AE8C5352A, 0x90C340C95ADD5F8C, 0xB543B329BED97C94, 0xAC0073A2B919B0A4, 0x6C0E7AAB1BF721DF, 0x241FE343116B3177, 0xCE8AD54D154C156, 0x82AF03859D69962D, 0x9C3C0FC3740C26D8, 0xDEBD472AA103A02B, 0x25D9E24A0748378B, 0x9C85AFE27F67725F, 0xEFF9FF84C9B3B1B4, 0x26BB94DC36FD0732, 0x4F49AAF26E4AEFB6};

// const fp inv_min_p_mod_r = {0x1, 0x0, 0x0, 0x0, 0xc90a05, 0x3455c4e, 0x30c3714, 0x103b3f1, 0x2bb966d, 0x409352, 0x33a1658, 0xd46a37, 0x171de14, 0x1d3af4b, 0x2ab6873, 0x1297ffc, 0x23ea1e7, 0x13a2d8c, 0x2d22069, 0x1e22551, 0x29417bc, 0x147d776, 0x28222ce, 0x53717, 0x22f8827, 0x1595d11, 0xc8fc11, 0x29da322, 0x2d05fdd, 0x3afdf86, 0xcfb957, 0x10c474, 0x2ae01e1, 0x1103c4f, 0x74c37f, 0x22de26e, 0x17ba58b, 0x265453f, 0x8b6c33, 0x1f81712, 0x2efa339, 0x2c98e7, 0x355be38, 0x3896a82, 0x179a45a, 0x87a4ad, 0x249f818, 0x154db2e, 0x246272b, 0x368b87b, 0x2a68143, 0x12beb9d, 0x3a5d173, 0x2ba41db, 0x558c34, 0xb22389, 0x73bb28, 0x332e7f6, 0xf82401, 0x9b3a11, 0x2d14325, 0x1c85065, 0x13dead1, 0x229c90f, 0x97f63d, 0xd95405, 0x4ad3dc, 0x32b487d, 0xe95848, 0x10819fc, 0xaa838e, 0x10c372d, 0x6f5ed4, 0x3088150, 0x3711676, 0x37608ad, 0x3ece557, 0x35aded9, 0x30ce0};

// const fp fp_0 = {0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0};

// const fp fp_2 = {0x6, 0x0, 0x0, 0x0, 0x349c3e2, 0x5fd62a, 0x1b6b583, 0x1e9c855, 0x110d206, 0x1d78f72, 0x16f73f5, 0x102d8ba, 0x3ea543b, 0x2c10ea8, 0x3162045, 0x19e7a71, 0x30badc1, 0x3edae8d, 0x3385e9a, 0x2d94af8, 0x395f72b, 0x3af0ca9, 0x36fdc72, 0x26a95a2, 0x115018d, 0x7c9747, 0x15757d, 0x2de9eb0, 0x21fcb0f, 0x1ec2210, 0xa9b1a6, 0x3d82d5f, 0x12ffc17, 0x13d24a4, 0x31da09e, 0x30c7fa6, 0xc6192a, 0x176d837, 0x3014f3e, 0x24feb98, 0x215d67c, 0xf7bddb, 0xb60c10, 0x788d7a, 0x3c2b65f, 0x2d1f7b3, 0x49b6c7, 0x21b9c52, 0x69cd05, 0x17708f0, 0xa2fa96, 0x307dff5, 0x1583534, 0x1ea47ff, 0x3cd7337, 0x2b1b65d, 0x3fb2740, 0xc600dd, 0x328bf00, 0x219ebc6, 0x1eade4f, 0x1bb3bf9, 0x2b47b71, 0x15a5e85, 0x1ea3efa, 0x15400e, 0x32b8c79, 0x10f513a, 0x11ce4b2, 0xe4d471, 0x1de0b10, 0x3571153, 0x2e345c9, 0x3980900, 0x3611d4c, 0x26a0b5a, 0x261bb17, 0x3945a8f, 0x2445f};

// const fp r_squared_mod_p = {0x532ed3, 0xae1a64, 0x134f1e9, 0x62127a, 0x35fb803, 0x2531e08, 0x1bdb25a, 0x311819b, 0x37a6049, 0x332c593, 0x2f02627, 0x56f85d, 0x3ef8ea2, 0x197b13e, 0x1c077f4, 0x332e6fd, 0x3bba507, 0x2ba066d, 0x5a4d09, 0x37ec4b2, 0x7a320e, 0x2418a4f, 0x16bb072, 0x11390ba, 0x25fbb76, 0x3a1e26a, 0x357d61a, 0x1dcc8de, 0x1652189, 0x97696a, 0x21c289f, 0x39cdb91, 0x29f28b6, 0x346c49a, 0x197a95b, 0x3bb0c8d, 0x2749745, 0x22dfdd6, 0x2389fa1, 0x7c75f0, 0xa60e03, 0x37d5e18, 0x1678e1c, 0x1731624, 0x37e7b0b, 0x22851b9, 0x2d8c986, 0x107cc8e, 0x252b0c2, 0x2e2d903, 0xa991bd, 0x325f848, 0x1979fdd, 0x510a6d, 0x3149fc6, 0x178cf2d, 0x5213b8, 0x3857938, 0x18d0c3, 0x1813395, 0x2a6dc81, 0x4a5200, 0x4dd482, 0x3f760cd, 0xc09bd0, 0x14de9e1, 0xfb36e6, 0x14ffd57, 0x2f626e0, 0xd51595, 0x1f790aa, 0xb5156a, 0x3a923a7, 0x11bcf5a, 0x2965fe3, 0x1d15527, 0x2d86756, 0x2bc7aca, 0x4559b};

// const fp p_minus_2 = {0x3fffffd, 0x3ffffff, 0x3ffffff, 0x3ffffff, 0xc90a04, 0x3455c4e, 0x30c3714, 0x103b3f1, 0x27d3254, 0x1b16817, 0x26d6cac, 0x7f868b, 0x358f1f6, 0x2dfd2e3, 0x2d1a549, 0x1baeb97, 0x2d3630a, 0xadb83d, 0x3769ae6, 0x311e2b, 0x2bc56ce, 0x20d7de3, 0xc2b097, 0x4391ba, 0x1d1d513, 0x95e6c9, 0x3fc6c6b, 0x1859037, 0xfab37d, 0x258a4fd, 0x1e3b7b9, 0x2b14dc5, 0x27800a6, 0x12079e4, 0x225ba90, 0x37deab9, 0x89a678, 0x26c314c, 0xd51d75, 0xf2ae11, 0x1a706eb, 0x281605b, 0x28c5352, 0x1ebe86b, 0x15f8c45, 0x3256b7, 0x1490c34, 0x2fb65f2, 0x143b329, 0x26c292d, 0x33a2b91, 0x37eb001, 0x31bf721, 0x3039eaa, 0x2b31776, 0x38d0c45, 0x156241f, 0x1345530, 0xce8ad5, 0x1a658b4, 0x303859d, 0x1b620ab, 0x3740c2, 0x270f03f, 0x103a02b, 0x351caa8, 0x378bdeb, 0x1281d20, 0x325d9e2, 0x3d9dc97, 0x5afe27, 0x2c6d272, 0x384c9b3, 0xbbfe7f, 0x36fd073, 0x2ee5370, 0x2efb626, 0x2bc9b92, 0x4f49a};

// const fp p_minus_1_halves = {0x3ffffff, 0x3ffffff, 0x3ffffff, 0x1ffffff, 0x648502, 0x1a2ae27, 0x3861b8a, 0x81d9f8, 0x33e992a, 0xd8b40b, 0x336b656, 0x3fc345, 0x3ac78fb, 0x36fe971, 0x368d2a4, 0xdd75cb, 0x369b185, 0x56dc1e, 0x3bb4d73, 0x188f15, 0x35e2b67, 0x306bef1, 0x61584b, 0x221c8dd, 0x2e8ea89, 0x24af364, 0x3fe3635, 0x2c2c81b, 0x27d59be, 0x32c527e, 0x2f1dbdc, 0x158a6e2, 0x13c0053, 0x903cf2, 0x312dd48, 0x1bef55c, 0x44d33c, 0x33618a6, 0x26a8eba, 0x2795708, 0x2d38375, 0x140b02d, 0x34629a9, 0x2f5f435, 0x2afc622, 0x192b5b, 0xa4861a, 0x37db2f9, 0x2a1d994, 0x3361496, 0x39d15c8, 0x3bf5800, 0x18dfb90, 0x181cf55, 0x3598bbb, 0x3c68622, 0xab120f, 0x29a2a98, 0x67456a, 0x2d32c5a, 0x381c2ce, 0xdb1055, 0x21ba061, 0x338781f, 0x81d015, 0x3a8e554, 0x1bc5ef5, 0x940e90, 0x392ecf1, 0x3ecee4b, 0x2d7f13, 0x3636939, 0x3c264d9, 0x25dff3f, 0x1b7e839, 0x17729b8, 0x177db13, 0x15e4dc9, 0x27a4d};

// const fp p_minus_3_quarters = {0x3ffffff, 0x3ffffff, 0x3ffffff, 0xffffff, 0x2324281, 0xd15713, 0x1c30dc5, 0x40ecfc, 0x39f4c95, 0x6c5a05, 0x39b5b2b, 0x21fe1a2, 0x3d63c7d, 0x1b7f4b8, 0x3b46952, 0x26ebae5, 0x1b4d8c2, 0x22b6e0f, 0x3dda6b9, 0x20c478a, 0x3af15b3, 0x3835f78, 0x230ac25, 0x310e46e, 0x1747544, 0x32579b2, 0x3ff1b1a, 0x161640d, 0x13eacdf, 0x196293f, 0x178edee, 0x2ac5371, 0x9e0029, 0x481e79, 0x1896ea4, 0xdf7aae, 0x22699e, 0x19b0c53, 0x135475d, 0x33cab84, 0x369c1ba, 0x2a05816, 0x3a314d4, 0x17afa1a, 0x357e311, 0xc95ad, 0x252430d, 0x1bed97c, 0x150ecca, 0x19b0a4b, 0x1ce8ae4, 0x1dfac00, 0x2c6fdc8, 0x2c0e7aa, 0x1acc5dd, 0x3e34311, 0x558907, 0x14d154c, 0x33a2b5, 0x169962d, 0x3c0e167, 0x26d882a, 0x30dd030, 0x39c3c0f, 0x40e80a, 0x3d472aa, 0xde2f7a, 0x24a0748, 0x3c97678, 0x3f67725, 0x216bf89, 0x3b1b49c, 0x3e1326c, 0x32eff9f, 0xdbf41c, 0x2bb94dc, 0x2bbed89, 0x2af26e4, 0x13d26};

// const fp p = {
// 0xFFFFFFFFFFFFFFFF,0xC90A04FFFFFFFFFF,0xFC70C3714D157138,0xC5A05E7D325440EC,
// 0xF61FE1A2E6D6CAC6,0x1A549B7F4B8F58F1,0xF6D3630A6EBAE5ED,0x478AF769AE62B6E0,
// 0x7835F78EBC56CE0C,0xD51310E46E8C2B09,0xFFC6C6B2579B25D1,0x93F4FAB37D61640D,
// 0xAC53715E3B7B9962,0xA90481E7927800A6,0x89A678DF7AAE625B,0x844D51D759B0C530,
// 0x5816DA706EB3CAB,0x457AFA1AE8C5352A,0x90C340C95ADD5F8C,0xB543B329BED97C94,
// 0xAC0073A2B919B0A4,0x6C0E7AAB1BF721DF,0x241FE343116B3177,0xCE8AD54D154C156,
// 0x82AF03859D69962D,0x9C3C0FC3740C26D8,0xDEBD472AA103A02B,0x25D9E24A0748378B,
// 0x9C85AFE27F67725F,0xEFF9FF84C9B3B1B4,0x26BB94DC36FD0732,0x4F49AAF26E4AEFB6};
// const fp r_squared_mod_p = {
// 0x1E92B86990532ED3,0x5FB80318849E934F,0x66DBDB25A94C7823,0xCB164F7A6049C460,
// 0xA215BE176F02627C,0x77F465EC4FBEF8E,0xB7BBA507CCB9BF5C,0xB12C85A4D09AE819,
// 0x2906293C7A320EDF,0xBB7644E42E96BB07,0xB57D61AE8789AA5F,0xA5A9652189773237,
// 0xE736E461C289F25D,0x95BD1B126A9F28B6,0x749745EEC323597A,0x7C2389FA18B7F75A,
// 0xF57860A60E031F1D,0xB5CC5891678E1CD,0x8C9868A146E77E7B,0xE52B0C241F323AD,
// 0x7E120A991BDB8B64,0x614429B5979FDDC9,0x13B85E33CB7149FC,0x418D0C3E15E4E052,
// 0x4802A6DC81604CE5,0xFDD83344DD482129,0x6E6537A784C09BD0,0xF626E053FF55CFB3,
// 0x5A9F790AA3545656,0x6F3D6BA923A72D45,0x56745549E965FE34,0x4559BAF1EB2AD867};
// const fp p_minus_2 = {
// 0xFFFFFFFFFFFFFFFD,0xC90A04FFFFFFFFFF,0xFC70C3714D157138,0xC5A05E7D325440EC,
// 0xF61FE1A2E6D6CAC6,0x1A549B7F4B8F58F1,0xF6D3630A6EBAE5ED,0x478AF769AE62B6E0,
// 0x7835F78EBC56CE0C,0xD51310E46E8C2B09,0xFFC6C6B2579B25D1,0x93F4FAB37D61640D,
// 0xAC53715E3B7B9962,0xA90481E7927800A6,0x89A678DF7AAE625B,0x844D51D759B0C530,
// 0x5816DA706EB3CAB,0x457AFA1AE8C5352A,0x90C340C95ADD5F8C,0xB543B329BED97C94,
// 0xAC0073A2B919B0A4,0x6C0E7AAB1BF721DF,0x241FE343116B3177,0xCE8AD54D154C156,
// 0x82AF03859D69962D,0x9C3C0FC3740C26D8,0xDEBD472AA103A02B,0x25D9E24A0748378B,
// 0x9C85AFE27F67725F,0xEFF9FF84C9B3B1B4,0x26BB94DC36FD0732,0x4F49AAF26E4AEFB6};
// const fp inv_min_p_mod_r = {
// 0x1,0xC90A050000000000,0xFC70C3714D157138,0x24D4ABB966D40EC,
// 0x14351A8DF3A16581,0xB687374EBD2D71DE,0x323EA1E74A5FFF2A,0x89546D220694E8B6,
// 0xE51F5DDA9417BC78,0x8827014DC5E8222C,0x8C8FC1156574462F,0x7E1AD05FDDA768C8,
// 0x4311D0CFB957EBF,0x37F440F13EAE01E1,0x7BA58B8B789B874C,0xC488B6C3399514FD,
// 0xB2639EEFA3397E05,0x5AE25AA0B55BE380,0x9F81821E92B579A4,0xEE46272B5536CBA4,
// 0xFAE76A68143DA2E1,0x4AE9076FA5D1734A,0xBB282C88E24558C3,0x4F82401CCB9FD873,
// 0x4196D1432526CE84,0x8A7243D3DEAD1721,0x3DC365501497F63D,0xE95848CAD21F44AD,
// 0xCB4AA838E42067F0,0x2205406F5ED4430D,0x57DD822B7711676C,0x30CE0D6B7B67ECE5};

// #ifdef MONTGOMERY
// const fp fp_1 = {
// 0x3,0xA4E1F10000000000,0xAADB5AC18BFAC55,0xAF1EE48869033D39,
// 0x1DA05B174B7B9FAB,0xB1022D821D51F52A,0x1B85D6E0B3CF4E38,0x295F19C2F4D7DB5D,
// 0x975E1953CAFB95DB,0x80C6CD52B45B7EE3,0xABABE8F92E8E8A,0x44210FE587DBD3D6,
// 0xFB05ABE54D8D33D8,0x4F27A494897FE0B,0x630C95618FF4D8ED,0x73180A79F2EDB06E,
// 0xEF7BB70AEB3E49FD,0x2F8F11AF45B06081,0x4DB63DA3EF67E15B,0xE034E682C3738A42,
// 0xFBFEA517D4B2EE11,0xBBD48FFEAC1A9A60,0x93A05636CBBE6B99,0xD945F8018C01BBFD,
// 0x77F2F56F27C33D78,0x2B4BD0B5A3DB8B76,0x63C82A801CF51F7D,0x8E725921EA27595C,
// 0x2A6EF05881C9A8E2,0x30120171A2E4EAE2,0x8BCD416B5B08EA67,0x1222FF28B51F30DD};
// const fp fp_2 = {
// 0x6, 0x49c3e20000000000, 0x155b6b58317f58ab, 0x5e3dc910d2067a72,
// 0x3b40b62e96f73f57, 0x62045b043aa3ea54, 0x370badc1679e9c71, 0x52be3385e9afb6ba,
// 0x2ebc32a795f72bb6, 0x018d9aa568b6fdc7, 0x015757d1f25d1d15, 0x88421fcb0fb7a7ac,
// 0xf60b57ca9b1a67b0, 0x09e4f492912ffc17, 0xc6192ac31fe9b1da, 0xe63014f3e5db60dc,
// 0xdef76e15d67c93fa, 0x5f1e235e8b60c103, 0x9b6c7b47decfc2b6, 0xc069cd0586e71484,
// 0xf7fd4a2fa965dc23, 0x77a91ffd583534c1, 0x2740ac6d977cd733, 0xb28bf003180377fb,
// 0xefe5eade4f867af1, 0x5697a16b47b716ec, 0xc790550039ea3efa, 0x1ce4b243d44eb2b8,
// 0x54dde0b1039351c5, 0x602402e345c9d5c4, 0x179a82d6b611d4ce, 0x2445fe516a3e61bb};

// #else
// const fp fp_1 = {0x1};
// const fp fp_2 = {0x2};
// #endif

#define pbits 2047
#define itch_size 128

#elif defined P4095k256
const fp p = {
    0xFFFFFFFFFFFFFFFF, 0xFFFFFFFFFFFFFFFF, 0xFFFFFFFFFFFFFFFF, 0xFFFFFFFFFFFFFFFF,
    0xFFFFFFFFFFFFFFFF, 0xFFFFFFFFFFFFFFFF, 0xFFFFFFFFFFFFFFFF, 0xFFFFFFFFFFFFFFFF,
    0xFFFFFFFFFFFFFFFF, 0xFFFFFFFFFFFFFFFF, 0xFFFFFFFFFFFFFFFF, 0xFFFFFFFFFFFFFFFF,
    0xFFFFFFFFFFFFFFFF, 0xFFFFFFFFFFFFFFFF, 0xFFFFFFFFFFFFFFFF, 0xFFFFFFFFFFFFFFFF,
    0xFFFFFFFFFFFFFFFF, 0xFFFFFFFFFFFFFFFF, 0xFFFFFFFFFFFFFFFF, 0xFFFFFFFFFFFFFFFF,
    0xFFFFFFFFFFFFFFFF, 0xFFFFFFFFFFFFFFFF, 0xFFFFFFFFFFFFFFFF, 0xFFFFFFFFFFFFFFFF,
    0xFFFFFFFFFFFFFFFF, 0xFFFFFFFFFFFFFFFF, 0x3B78D7B10F1CB8F4, 0x65888C198A8E59FB,
    0x69596010D2245505, 0xFB85D331BF15DBF3, 0x37972594A6C994EE, 0x96FE98E120B09BC3,
    0x58BD5BBBA27779BC, 0xD3F92A67C4103933, 0x31E5FF951B6D7341, 0xDBDCE9C5B4A495F,
    0xF7F6282402F363A1, 0x3B060DB5E11AB944, 0x4EC8B118AF8DBC53, 0xDDE49F6161571FD8,
    0x71157D20BF37675A, 0x797E5708F727ED74, 0x2321418BC30A539A, 0xA44FA639976AC4E7,
    0x91C11928B06E3FBE, 0x4CB0C8F4D65A4621, 0x8B8D69E7AC15EC05, 0xAF581DAD341E7736,
    0x6797C15ADE6FC067, 0x920FAD0AB8C53DEC, 0xC1E76D615C55D39C, 0xEB058573CE240F88,
    0xA556349D51FF4F46, 0x62F3FCAC66D97C78, 0x5F9B0D210C56F8F0, 0xAB53247F88DF7F7A,
    0x94116953CE9E76FF, 0xA22108FBBF709EBF, 0xB961C86B9AB57C35, 0x533F33CAA89E8487,
    0x608D0FF735D0ABB9, 0xAADE61945F8AE99F, 0x627B08FEB90A8490, 0x47DF1BED926B3AC9};
const fp r_squared_mod_p = {
    0x8CEB127293B0D704, 0xF6F72C762D6DA787, 0x2C2F3D0FAF67F933, 0xC25B2850C4F4193E,
    0x9A678B4FF54EB5A4, 0x9D6236228FB18067, 0xEFE8CB65B11F08DA, 0x6074CFD77BEB1CBC,
    0x31883F4A8EBF2C55, 0x207E6C10953ECDD0, 0x6874464FEAD08F83, 0x2764C5C70E94D22F,
    0x3A196117F0B920F3, 0xD41C09B42FE3C3FD, 0xFDA59BF94226BF9A, 0x3517155CE4EA53A,
    0xD2A580301605450B, 0x6B1B4D93EBE208C, 0x1D24827C2D1916A2, 0x738960E14B4E2A99,
    0x9EC7F26C1B71FD8F, 0xD3A0B01F5FF48D05, 0x2845B005F22D1711, 0x5A2FD859961662E2,
    0xCDCCC40B84FACC87, 0xD70850291493F70F, 0xFDE3B73099132CB9, 0x3F31F0F1E22D6E1F,
    0x5AC847972D3F8EC4, 0x71201AA1487BFB7D, 0x505D34A9355C4881, 0x47BCE102473AE042,
    0x694961ECC06D5F98, 0xF129E5E25CCC1C12, 0x472300FAF52800E8, 0x53B7642D6AEC1C53,
    0x9890F4E3A4AB73F7, 0xBD68A5953ACF687F, 0x73005602CFF41D2F, 0x7BC084C52CE0736,
    0xC2EA369EA7D6A3B0, 0x5D8F10918E2CFB26, 0x4070FF9EAFADB430, 0xC3014147D6332AB3,
    0x49EFD7D05F6A8D18, 0x3828E89F04ABF2FF, 0x7D436F0936DEAE3A, 0x9866A93C9A5D3AD4,
    0xD714A1916FA0BFAE, 0x43A89E702A9598CB, 0xDBC52BC7C60F2FBF, 0xAA4D06F901D5D799,
    0xCD4F26C8018FA82B, 0x5F89C7DEAE47E7B6, 0x777D70F2200928CA, 0x5DD16AE14FE42617,
    0x1BC9EF3D7E94BB8C, 0xEC8B2C6080C5FFCE, 0x506761F0BB39F20E, 0x1BD448693A223E3C,
    0x3AAD6B3D7668FC70, 0xE075635F2D38AB3B, 0x8C53BC929CBA4C14, 0x3862B62F31789C4B};
const fp p_minus_2 = {
    0xFFFFFFFFFFFFFFFD, 0xFFFFFFFFFFFFFFFF, 0xFFFFFFFFFFFFFFFF, 0xFFFFFFFFFFFFFFFF,
    0xFFFFFFFFFFFFFFFF, 0xFFFFFFFFFFFFFFFF, 0xFFFFFFFFFFFFFFFF, 0xFFFFFFFFFFFFFFFF,
    0xFFFFFFFFFFFFFFFF, 0xFFFFFFFFFFFFFFFF, 0xFFFFFFFFFFFFFFFF, 0xFFFFFFFFFFFFFFFF,
    0xFFFFFFFFFFFFFFFF, 0xFFFFFFFFFFFFFFFF, 0xFFFFFFFFFFFFFFFF, 0xFFFFFFFFFFFFFFFF,
    0xFFFFFFFFFFFFFFFF, 0xFFFFFFFFFFFFFFFF, 0xFFFFFFFFFFFFFFFF, 0xFFFFFFFFFFFFFFFF,
    0xFFFFFFFFFFFFFFFF, 0xFFFFFFFFFFFFFFFF, 0xFFFFFFFFFFFFFFFF, 0xFFFFFFFFFFFFFFFF,
    0xFFFFFFFFFFFFFFFF, 0xFFFFFFFFFFFFFFFF, 0x3B78D7B10F1CB8F4, 0x65888C198A8E59FB,
    0x69596010D2245505, 0xFB85D331BF15DBF3, 0x37972594A6C994EE, 0x96FE98E120B09BC3,
    0x58BD5BBBA27779BC, 0xD3F92A67C4103933, 0x31E5FF951B6D7341, 0xDBDCE9C5B4A495F,
    0xF7F6282402F363A1, 0x3B060DB5E11AB944, 0x4EC8B118AF8DBC53, 0xDDE49F6161571FD8,
    0x71157D20BF37675A, 0x797E5708F727ED74, 0x2321418BC30A539A, 0xA44FA639976AC4E7,
    0x91C11928B06E3FBE, 0x4CB0C8F4D65A4621, 0x8B8D69E7AC15EC05, 0xAF581DAD341E7736,
    0x6797C15ADE6FC067, 0x920FAD0AB8C53DEC, 0xC1E76D615C55D39C, 0xEB058573CE240F88,
    0xA556349D51FF4F46, 0x62F3FCAC66D97C78, 0x5F9B0D210C56F8F0, 0xAB53247F88DF7F7A,
    0x94116953CE9E76FF, 0xA22108FBBF709EBF, 0xB961C86B9AB57C35, 0x533F33CAA89E8487,
    0x608D0FF735D0ABB9, 0xAADE61945F8AE99F, 0x627B08FEB90A8490, 0x47DF1BED926B3AC9};
const fp inv_min_p_mod_r = {
    0x1, 0x0, 0x0, 0x0,
    0x0, 0x0, 0x0, 0x0,
    0x0, 0x0, 0x0, 0x0,
    0x0, 0x0, 0x0, 0x0,
    0x0, 0x0, 0x0, 0x0,
    0x0, 0x0, 0x0, 0x0,
    0x0, 0x0, 0x3B78D7B10F1CB8F5, 0x65888C198A8E59FB,
    0x69596010D2245505, 0xFB85D331BF15DBF3, 0x37972594A6C994EE, 0x96FE98E120B09BC3,
    0x58BD5BBBA27779BC, 0xD3F92A67C4103933, 0x31E5FF951B6D7341, 0xDBDCE9C5B4A495F,
    0xF7F6282402F363A1, 0x3B060DB5E11AB944, 0x4EC8B118AF8DBC53, 0xDDE49F6161571FD8,
    0x71157D20BF37675A, 0x797E5708F727ED74, 0x2321418BC30A539A, 0xA44FA639976AC4E7,
    0x91C11928B06E3FBE, 0x4CB0C8F4D65A4621, 0x8B8D69E7AC15EC05, 0xAF581DAD341E7736,
    0x6797C15ADE6FC067, 0x920FAD0AB8C53DEC, 0xC1E76D615C55D39C, 0xEB058573CE240F88,
    0x1E4DDE4D033869BF, 0x76A4CDF7DE42D0ED, 0xFFE1FB1A29364E96, 0x81B7B1FF511C7342,
    0x81B1EB832A15CDD8, 0xABA6009D22442780, 0x2A50A3CE638F0A8D, 0x9B06B7FFE9FE1497,
    0x64879D49C5545B7F, 0x8E5383DBA6ECD49F, 0xB4FE5691BB843398, 0xD01F2660CBA92AC3};

#ifdef MONTGOMERY
const fp fp_1 = {
    0x3, 0x0, 0x0, 0x0,
    0x0, 0x0, 0x0, 0x0,
    0x0, 0x0, 0x0, 0x0,
    0x0, 0x0, 0x0, 0x0,
    0x0, 0x0, 0x0, 0x0,
    0x0, 0x0, 0x0, 0x0,
    0x0, 0x0, 0x4D9578ECD2A9D521, 0xCF665BB36054F20E,
    0xC3F3DFCD899300EF, 0xD6E866AC2BE6C25, 0x593A8F420BA34133, 0x3B04355C9DEE2CB6,
    0xF5C7ECCD189992CA, 0x841480C8B3CF5465, 0x6A4E0140ADB7A63A, 0xD6C6942AEE2123E2,
    0x181D8793F725D51C, 0x4EEDD6DE5CAFD431, 0x13A5ECB5F156CB06, 0x665221DBDBFAA077,
    0xACBF889DC259C9EF, 0x9384FAE51A8837A2, 0x969C3B5CB6E10530, 0x13110D5339BFB14A,
    0x4ABCB485EEB540C4, 0x19EDA5217CF12D9B, 0x5D57C248FBBE3BF0, 0xF1F7A6F863A49A5C,
    0xC938BBEF64B0BEC8, 0x49D0F8DFD5B0463A, 0xBA49B7DBEAFE852A, 0x3EEF6FA49593D165,
    0xFFD62280A02122B, 0xD72409FACB738A96, 0xE12ED89CDAFB152E, 0xFE06928165618190,
    0x43CBC40494249B00, 0x199CE50CC1AE23C1, 0xD3DAA6BD2FDF8B5F, 0x64264A006247268,
    0xDE58D01A5E8DFCD4, 0xFF64DB42E15F4321, 0xD88EE503D4E0724D, 0x2862AC3748BE4FA3};
const fp fp_2 = {
    0x7, 0x0, 0x0, 0x0,
    0x0, 0x0, 0x0, 0x0,
    0x0, 0x0, 0x0, 0x0,
    0x0, 0x0, 0x0, 0x0,
    0x0, 0x0, 0x0, 0x0,
    0x0, 0x0, 0x0, 0x0,
    0x0, 0x0, 0x5fb21a289636f14d, 0x39442b4d361b8a21,
    0x1e8e5f8a4101acda, 0x1f5739a3c666fc58, 0x7addf8ef707ced77, 0xdf09d1d81b2bbda9,
    0x92d27dde8ebbabd7, 0x342fd729a38e6f98, 0xa2b602ec4001d933, 0x9fcf59b980f7fe65,
    0x3844e703eb584698, 0x62d5a006d844ef1d, 0xd8832853331fd9b9, 0xeebfa456569e2115,
    0xe869941ac57c2c83, 0xad8b9ec13de881d0, 0x0a17352daab7b6c6, 0x81d2746cdc149dae,
    0x03b84fe32cfc41c9, 0xe72a814e23881515, 0x2f221aaa4b668bda, 0x34973043932abd82,
    0x2ad9b683eaf1bd2a, 0x019244b4f29b4e89, 0xb2ac025679a736b8, 0x92d959d55d039342,
    0x7aa48fb2c204d50f, 0x4b541749300d98b3, 0x62c2a418a99f316d, 0x50ba008341e383a7,
    0xf3861eb559aabf02, 0x9118c11dc3eba8c2, 0xee53850ec5099a88, 0xb945957563aa6049,
    0x5c24903d874b4dee, 0x53eb54f163339ca4, 0x4ea2c108f0b6600b, 0x08e63c80ff11647e};
#else
const fp fp_1 = {0x1};
const fp fp_2 = {0x2};
#endif

#define pbits 4095
#define itch_size 256

#elif defined P5119k234
const fp p = {
    0xFFFFFFFFFFFFFFFF, 0xFFFFFFFFFFFFFFFF, 0xFFFFFFFFFFFFFFFF, 0xFFFFFFFFFFFFFFFF,
    0xFFFFFFFFFFFFFFFF, 0xFFFFFFFFFFFFFFFF, 0xFFFFFFFFFFFFFFFF, 0xFFFFFFFFFFFFFFFF,
    0xFFFFFFFFFFFFFFFF, 0xFFFFFFFFFFFFFFFF, 0xFFFFFFFFFFFFFFFF, 0xFFFFFFFFFFFFFFFF,
    0xFFFFFFFFFFFFFFFF, 0xFFFFFFFFFFFFFFFF, 0xFFFFFFFFFFFFFFFF, 0xFFFFFFFFFFFFFFFF,
    0xFFFFFFFFFFFFFFFF, 0xFFFFFFFFFFFFFFFF, 0xFFFFFFFFFFFFFFFF, 0xFFFFFFFFFFFFFFFF,
    0xFFFFFFFFFFFFFFFF, 0xFFFFFFFFFFFFFFFF, 0xFFFFFFFFFFFFFFFF, 0xFFFFFFFFFFFFFFFF,
    0xFFFFFFFFFFFFFFFF, 0xFFFFFFFFFFFFFFFF, 0xFFFFFFFFFFFFFFFF, 0xFFFFFFFFFFFFFFFF,
    0xFFFFFFFFFFFFFFFF, 0xFFFFFFFFFFFFFFFF, 0xFFFFFFFFFFFFFFFF, 0xFFFFFFFFFFFFFFFF,
    0xFFFFFFFFFFFFFFFF, 0xFFFFFFFFFFFFFFFF, 0xFFFFFFFFFFFFFFFF, 0xFFFFFFFFFFFFFFFF,
    0xFFFFFFFFFFFFFFFF, 0xFFFFFFFFFFFFFFFF, 0xFFFFFFFFFFFFFFFF, 0xFFFFFFFFFFFFFFFF,
    0xFFFFFFFFFFFFFFFF, 0xFFFFFFFFFFFFFFFF, 0xFFFFFFFFFFFFFFFF, 0xFFFFFFFFFFFFFFFF,
    0xFFFFFFFFFFFFFFFF, 0x31C122B2FFFFFFFF, 0x71BAB792CCF26C33, 0xF100763480D81D65,
    0xA2A4D3AFCD84CB1, 0xA5277C5A1EDF4274, 0x83B80791506A02BE, 0x99A550E13C0F216,
    0xB269F7EFF29EE16B, 0x4433973B01A89610, 0x321DA18B685FA986, 0x257F8CBB1AD63459,
    0x8B0742F099C755E4, 0x182DC9E83CC912B1, 0xB30D2E40DB42513A, 0x80643C752D3F0BF,
    0xB1FE257416D05092, 0x4DF7CBB62E4281F0, 0xA1160AC1B85C89AD, 0x4A2E0B5D9E3D744A,
    0x966A6C73F126A7FA, 0xD2257BED2C00854, 0x4A4BF83147C01F3A, 0xD9059C466BA6095B,
    0xCBA1D52981546D14, 0x3EB030EFE24F606E, 0x1AEDFF7ABBD03380, 0x5D98DDB04F236AC6,
    0x1F166B7A23E849B5, 0x25529CD9B432F707, 0xC76F78378B762434, 0x994DE9FA51639C1D,
    0x4907FB14725711F2, 0x2132F7B67412060B, 0x93A14A8A040ECBD4, 0x6020EB29A152AD5F};
const fp r_squared_mod_p = {
    0xAB8D32CD0B87207, 0x5F461666E7E79360, 0x7092171475A40C6E, 0xC464ED8264543B4C,
    0x4B50232555441385, 0x91A81C1E1A350BB5, 0xC6AF140A89B07853, 0x37C31CF40F30DD90,
    0x9032842FC3670A46, 0x337CECD583C1691, 0x42548094A2338D1D, 0x102DD35C52452E04,
    0xD70713A1F1482AAD, 0xE94CA85977C0C433, 0x58F87FAC5B8BBC3C, 0xB089F768247C245D,
    0x6CC80D442FBC7059, 0x7FCF3800F4E5D5D9, 0xFC29B7FF3927A60, 0x86F75DCB99BA2F7B,
    0x274C8D2FD1FFCFAF, 0xA1861111341EEE2D, 0x617426C57CBF596B, 0x39A8B63C216E21E4,
    0x1F053CD165527E05, 0x819B95949403C8C9, 0xE43870C47E2AF7B9, 0xD5D0B4EBACFFDE66,
    0x5B439C562E5FA6FF, 0x50CF6F047F060428, 0x628B3803C9735690, 0xC86F2DC383807685,
    0xD3CD5F10CB17B9B0, 0x41B185FBE374C01C, 0x6A954DC6D9115C7, 0x10DE360A8FD9F236,
    0xDA202ECAFE7FDDF3, 0x7A3EA4DA27924F7C, 0x85C621121AF37032, 0x4A9D1BBF17CD2CD,
    0x9CC28671EE2C9DC8, 0xC238DE9A50E6D904, 0x47B37C1EA5C43FE9, 0x61A9433960C08A36,
    0x968090E3F88D03BF, 0xDFCD7FEF03D1068D, 0xD92EF8E28F37F467, 0xFDB7B2178AA37D7A,
    0x30F1AF5F680AD79A, 0x2E9C842430B98174, 0xC751A8EEB0C3CF7A, 0x4A9C5A18193BED52,
    0xC91C1E6B88876893, 0x842D2099153ED8B0, 0x951660523DC34645, 0xBC228B1E5350C76A,
    0xEEE4B31ED1F161A, 0x8D649A97BE8F6A2, 0x339555E21320FD56, 0x8FC655DF9605D21E,
    0x10FD5F72C15FD193, 0x5069FBB94FCED402, 0x375DDDA904648B33, 0x66FD95C16A1FBC83,
    0xD214D627DFFF3CAD, 0xA137B3E705DC8506, 0x7FDB56022E49A8BE, 0x52948BF50EE10863,
    0x89E3D0B4AF41454A, 0xFFC422971D6D0FB2, 0x45B89C48A05D6CEE, 0x805E6A7D584606ED,
    0x952A8A9A0E23DCB3, 0xF6276E4CB686A6E9, 0xF20D25FFB8D55C02, 0xE928758091C0C2BB,
    0x9A5769B9C6CBB7BA, 0x395078F7E8B28921, 0xFBAB7129813F2B3A, 0x5AEBF04CA077035E};
const fp p_minus_2 = {
    0xFFFFFFFFFFFFFFFD, 0xFFFFFFFFFFFFFFFF, 0xFFFFFFFFFFFFFFFF, 0xFFFFFFFFFFFFFFFF,
    0xFFFFFFFFFFFFFFFF, 0xFFFFFFFFFFFFFFFF, 0xFFFFFFFFFFFFFFFF, 0xFFFFFFFFFFFFFFFF,
    0xFFFFFFFFFFFFFFFF, 0xFFFFFFFFFFFFFFFF, 0xFFFFFFFFFFFFFFFF, 0xFFFFFFFFFFFFFFFF,
    0xFFFFFFFFFFFFFFFF, 0xFFFFFFFFFFFFFFFF, 0xFFFFFFFFFFFFFFFF, 0xFFFFFFFFFFFFFFFF,
    0xFFFFFFFFFFFFFFFF, 0xFFFFFFFFFFFFFFFF, 0xFFFFFFFFFFFFFFFF, 0xFFFFFFFFFFFFFFFF,
    0xFFFFFFFFFFFFFFFF, 0xFFFFFFFFFFFFFFFF, 0xFFFFFFFFFFFFFFFF, 0xFFFFFFFFFFFFFFFF,
    0xFFFFFFFFFFFFFFFF, 0xFFFFFFFFFFFFFFFF, 0xFFFFFFFFFFFFFFFF, 0xFFFFFFFFFFFFFFFF,
    0xFFFFFFFFFFFFFFFF, 0xFFFFFFFFFFFFFFFF, 0xFFFFFFFFFFFFFFFF, 0xFFFFFFFFFFFFFFFF,
    0xFFFFFFFFFFFFFFFF, 0xFFFFFFFFFFFFFFFF, 0xFFFFFFFFFFFFFFFF, 0xFFFFFFFFFFFFFFFF,
    0xFFFFFFFFFFFFFFFF, 0xFFFFFFFFFFFFFFFF, 0xFFFFFFFFFFFFFFFF, 0xFFFFFFFFFFFFFFFF,
    0xFFFFFFFFFFFFFFFF, 0xFFFFFFFFFFFFFFFF, 0xFFFFFFFFFFFFFFFF, 0xFFFFFFFFFFFFFFFF,
    0xFFFFFFFFFFFFFFFF, 0x31C122B2FFFFFFFF, 0x71BAB792CCF26C33, 0xF100763480D81D65,
    0xA2A4D3AFCD84CB1, 0xA5277C5A1EDF4274, 0x83B80791506A02BE, 0x99A550E13C0F216,
    0xB269F7EFF29EE16B, 0x4433973B01A89610, 0x321DA18B685FA986, 0x257F8CBB1AD63459,
    0x8B0742F099C755E4, 0x182DC9E83CC912B1, 0xB30D2E40DB42513A, 0x80643C752D3F0BF,
    0xB1FE257416D05092, 0x4DF7CBB62E4281F0, 0xA1160AC1B85C89AD, 0x4A2E0B5D9E3D744A,
    0x966A6C73F126A7FA, 0xD2257BED2C00854, 0x4A4BF83147C01F3A, 0xD9059C466BA6095B,
    0xCBA1D52981546D14, 0x3EB030EFE24F606E, 0x1AEDFF7ABBD03380, 0x5D98DDB04F236AC6,
    0x1F166B7A23E849B5, 0x25529CD9B432F707, 0xC76F78378B762434, 0x994DE9FA51639C1D,
    0x4907FB14725711F2, 0x2132F7B67412060B, 0x93A14A8A040ECBD4, 0x6020EB29A152AD5F};
const fp inv_min_p_mod_r = {
    0x1, 0x0, 0x0, 0x0,
    0x0, 0x0, 0x0, 0x0,
    0x0, 0x0, 0x0, 0x0,
    0x0, 0x0, 0x0, 0x0,
    0x0, 0x0, 0x0, 0x0,
    0x0, 0x0, 0x0, 0x0,
    0x0, 0x0, 0x0, 0x0,
    0x0, 0x0, 0x0, 0x0,
    0x0, 0x0, 0x0, 0x0,
    0x0, 0x0, 0x0, 0x0,
    0x0, 0x0, 0x0, 0x0,
    0x0, 0x31C122B300000000, 0x71BAB792CCF26C33, 0xF100763480D81D65,
    0xA2A4D3AFCD84CB1, 0xA5277C5A1EDF4274, 0x83B80791506A02BE, 0x99A550E13C0F216,
    0xB269F7EFF29EE16B, 0x4433973B01A89610, 0x321DA18B685FA986, 0x257F8CBB1AD63459,
    0x8B0742F099C755E4, 0x182DC9E83CC912B1, 0xB30D2E40DB42513A, 0x80643C752D3F0BF,
    0xB1FE257416D05092, 0x4DF7CBB62E4281F0, 0xA1160AC1B85C89AD, 0x4A2E0B5D9E3D744A,
    0x966A6C73F126A7FA, 0xD2257BED2C00854, 0x4A4BF83147C01F3A, 0xD9059C466BA6095B,
    0xCBA1D52981546D14, 0x3EB030EFE24F606E, 0x1AEDFF7ABBD03380, 0x5D98DDB04F236AC6,
    0x1F166B7A23E849B5, 0x25529CD9B432F707, 0xC76F78378B762434, 0x994DE9FA51639C1D,
    0x4907FB14725711F2, 0x2132F7B67412060B, 0x93A14A8A040ECBD4, 0x6020EB29A152AD5F};

#ifdef MONTGOMERY
const fp fp_1 = {
    0x2, 0x0, 0x0, 0x0,
    0x0, 0x0, 0x0, 0x0,
    0x0, 0x0, 0x0, 0x0,
    0x0, 0x0, 0x0, 0x0,
    0x0, 0x0, 0x0, 0x0,
    0x0, 0x0, 0x0, 0x0,
    0x0, 0x0, 0x0, 0x0,
    0x0, 0x0, 0x0, 0x0,
    0x0, 0x0, 0x0, 0x0,
    0x0, 0x0, 0x0, 0x0,
    0x0, 0x0, 0x0, 0x0,
    0x0, 0x9C7DBA9A00000000, 0x1C8A90DA661B2799, 0x1DFF1396FE4FC535,
    0xEBAB658A064F669C, 0xB5B1074BC2417B17, 0xF88FF0DD5F2BFA82, 0xECCB55E3D87E1BD2,
    0x9B2C10201AC23D29, 0x7798D189FCAED3DE, 0x9BC4BCE92F40ACF3, 0xB500E689CA53974D,
    0xE9F17A1ECC715437, 0xCFA46C2F866DDA9C, 0x99E5A37E497B5D8B, 0xEFF378715A581E80,
    0x9C03B517D25F5EDB, 0x64106893A37AFC1E, 0xBDD3EA7C8F46ECA5, 0x6BA3E944C385176A,
    0xD32B27181DB2B00B, 0xE5BB50825A7FEF56, 0x6B680F9D707FC18B, 0x4DF4C77328B3ED49,
    0x68BC55ACFD5725D6, 0x829F9E203B613F22, 0xCA24010A885F98FF, 0x44CE449F61B92A73,
    0xC1D3290BB82F6C95, 0xB55AC64C979A11F1, 0x71210F90E913B797, 0xCD642C0B5D38C7C4,
    0x6DF009D71B51DC1A, 0xBD9A109317DBF3E9, 0xD8BD6AEBF7E26857, 0x3FBE29ACBD5AA540};
const fp fp_2 = {
    0x5, 0x0, 0x0, 0x0,
    0x0, 0x0, 0x0, 0x0,
    0x0, 0x0, 0x0, 0x0,
    0x0, 0x0, 0x0, 0x0,
    0x0, 0x0, 0x0, 0x0,
    0x0, 0x0, 0x0, 0x0,
    0x0, 0x0, 0x0, 0x0,
    0x0, 0x0, 0x0, 0x0,
    0x0, 0x0, 0x0, 0x0,
    0x0, 0x0, 0x0, 0x0,
    0x0, 0x0, 0x0, 0x0,
    0x0, 0x073a528100000000, 0xc75a6a21ff43e300, 0x4afdb0f97bc76d04,
    0xcd2c7dd90fc68086, 0xc63a923d65a3b3bb, 0x6d67da296dedf246, 0xcffc56b99d3b458f,
    0x83ee285042e598e8, 0xaafe0bd8f7b511ac, 0x056bd846f621b060, 0x4482405879d0fa42,
    0x48dbb14cff1b528b, 0x871b0e76d012a288, 0x80be18bbb7b469dd, 0xd7e0ad1b61dc4c41,
    0x860944bb8dee6d25, 0x7a29057118b3764c, 0xda91ca3766314f9d, 0x8d19c72be8ccba8a,
    0x0febe1bc4a3eb81c, 0xbe544945e23fd659, 0x8c842709993f63dd, 0xc2e3f29fe5c1d137,
    0x05d6d6307959de97, 0xc68f0b5094731dd6, 0x795a029a54eefe7e, 0x2c03ab8e744eea21,
    0x648fe69d4c768f75, 0x4562efbf7b012cdc, 0x1ad2a6ea46b14afb, 0x017a6e1c690df36b,
    0x92d81899c44ca643, 0x5a01296fbba5e1c7, 0x1dd98b4debb604db, 0x1f5b682fd9629d22};
#else
const fp fp_1 = {0x1};
const fp fp_2 = {0x2};
#endif

#define pbits 5119
#define itch_size 322

#elif defined P6143k256
const fp p = {
    0xFFFFFFFFFFFFFFFF, 0xFFFFFFFFFFFFFFFF, 0xFFFFFFFFFFFFFFFF, 0xFFFFFFFFFFFFFFFF,
    0xFFFFFFFFFFFFFFFF, 0xFFFFFFFFFFFFFFFF, 0xFFFFFFFFFFFFFFFF, 0xFFFFFFFFFFFFFFFF,
    0xFFFFFFFFFFFFFFFF, 0xFFFFFFFFFFFFFFFF, 0xFFFFFFFFFFFFFFFF, 0xFFFFFFFFFFFFFFFF,
    0xFFFFFFFFFFFFFFFF, 0xFFFFFFFFFFFFFFFF, 0xFFFFFFFFFFFFFFFF, 0xFFFFFFFFFFFFFFFF,
    0xFFFFFFFFFFFFFFFF, 0xFFFFFFFFFFFFFFFF, 0xFFFFFFFFFFFFFFFF, 0xFFFFFFFFFFFFFFFF,
    0xFFFFFFFFFFFFFFFF, 0xFFFFFFFFFFFFFFFF, 0xFFFFFFFFFFFFFFFF, 0xFFFFFFFFFFFFFFFF,
    0xFFFFFFFFFFFFFFFF, 0xFFFFFFFFFFFFFFFF, 0xFFFFFFFFFFFFFFFF, 0xFFFFFFFFFFFFFFFF,
    0xFFFFFFFFFFFFFFFF, 0xFFFFFFFFFFFFFFFF, 0xFFFFFFFFFFFFFFFF, 0xFFFFFFFFFFFFFFFF,
    0xFFFFFFFFFFFFFFFF, 0xFFFFFFFFFFFFFFFF, 0xFFFFFFFFFFFFFFFF, 0xFFFFFFFFFFFFFFFF,
    0xFFFFFFFFFFFFFFFF, 0xFFFFFFFFFFFFFFFF, 0xFFFFFFFFFFFFFFFF, 0xFFFFFFFFFFFFFFFF,
    0xFFFFFFFFFFFFFFFF, 0xFFFFFFFFFFFFFFFF, 0xFFFFFFFFFFFFFFFF, 0xFFFFFFFFFFFFFFFF,
    0xFFFFFFFFFFFFFFFF, 0xFFFFFFFFFFFFFFFF, 0xFFFFFFFFFFFFFFFF, 0xFFFFFFFFFFFFFFFF,
    0xFFFFFFFFFFFFFFFF, 0xFFFFFFFFFFFFFFFF, 0xFFFFFFFFFFFFFFFF, 0xFFFFFFFFFFFFFFFF,
    0xFFFFFFFFFFFFFFFF, 0xFFFFFFFFFFFFFFFF, 0xFFFFFFFFFFFFFFFF, 0xFFFFFFFFFFFFFFFF,
    0xFFFFFFFFFFFFFFFF, 0xFFFFFFFFFFFFFFFF, 0xB1A73428FFFFFFFF, 0x3C7EA8E3C554965A,
    0x40803AF2FC159EF2, 0xCCFB305C48D4D505, 0x6B8EF3BD24FA010D, 0x2674B4838FAD59EB,
    0x5C175CC1BE876A7, 0xC5D744BAF4074152, 0x92C4B7DD1100ADFA, 0x274E59F92BD34D4D,
    0x3CF8373B1A6D448D, 0x41DF8B0B4F3E178B, 0x4EBFB033649A8012, 0xA4FC04DEB27F0F97,
    0x531B77E3E1EB32A2, 0x91707210201D3A74, 0x79DABE4D2F2A1E0F, 0x7837DAA51F59CDFA,
    0x91CBFF70AC345B5A, 0x25223E09B7BF27C4, 0x1D384E247A3FA6BD, 0x9A2FFACBA15A6110,
    0x92D9ECF65F9B3FD4, 0x6C0E75F1235909CE, 0xE3945BA3564DD650, 0x79A5B88C7FE6D95F,
    0xC83174128DC676F, 0x792C81C648CAB8CB, 0x12EBE4E03BCBD891, 0x251ACCA5A5EB867E,
    0x260DE537CDB28252, 0xF6F73F7357DD8F6E, 0x80480988522C5703, 0x1D8333732C8142B5,
    0x305E539F114AD8ED, 0xBB6D10EB0C6C11E5, 0x4C32EAB208C6E5CE, 0x4B52CCE89E8E10AA};
const fp r_squared_mod_p = {
    0x356A3BB63F72F40D, 0x937792E976731C8, 0xBFD828ADE2231794, 0xB1811EE89E61BE5A,
    0x77DAA4C8973D07A5, 0x475321BF795B66DF, 0x2E9304B5D34E8A5A, 0x3F1CCA18B4157FF3,
    0x840B2654C5944D34, 0x7C9E3FA457731538, 0xDA7F2C85FF0155CC, 0xDB18CA3406897810,
    0x2CE38B8E937763F6, 0x9FDE4376DE841559, 0x610B201D33C84292, 0x47B10F7B253096FA,
    0xDB73A82985D4BC9F, 0x4B3C8467C3E59A9D, 0xD5AA1BCFF5690670, 0xC23D4B0056CD1F90,
    0xEB5A0F773EDA24A8, 0x70EC974E2D469604, 0xF4C62BF1983F914F, 0x6272AA9D1F4B3A4C,
    0x3B1718FEA9DDF11A, 0x2DE0B5A725BECF66, 0xCE1DAC7E8DF1F8FB, 0xB514D1A46EE60FE1,
    0xA5869A19C4179414, 0x9B81C117D81612AF, 0xBAC09C37CFBF87F1, 0x8EBF4388B563C822,
    0x313367080A1CE9D5, 0xFF823F98F5753B8D, 0xF1D98DC03F4C9AA2, 0x4351D1373DBD8DB6,
    0x70F22CE9C83D6E7A, 0x6D4DE0D21DD44F05, 0xFAF09B25DE74EF78, 0xBDE5569FCCB4BF8A,
    0x6A448A41739AE3D0, 0x41398B4622B5415E, 0x37F8E66E26F54827, 0x96A5526EDEDCF979,
    0xAE3983ECE2CE489D, 0xF114963568F2923C, 0x18FF1167C172B3, 0xF1CD27098381C939,
    0xC09A77ED5E9EE34A, 0xA8B3338378B3EE28, 0xE76E5F3F30F3862, 0xF6BDFAB9634BCC48,
    0x833EB60ACE2B6ECA, 0xB058C5BA80F0590B, 0xEB5F2DCDAFB14F6F, 0xB9A9A517972FAE8A,
    0x5AE417B84E3E912D, 0x1B4159FC854344AD, 0xE546ACCD6A88C135, 0xA46450A370A7020,
    0x8E145CD187953126, 0x1C1163ECD815889E, 0x3236A19ABCB251C1, 0xC25216E7899FD602,
    0x4D3470A1C2DE626C, 0xAF7975769E0BC178, 0x848A0A7E47B606D2, 0x36BF74A730A7CA3A,
    0x3751518341B1E979, 0x5F3D00816BFAA3DF, 0x49147E2ABF2231C4, 0x83D1C4EF5187A4E1,
    0x37FB3D5DAFFFF021, 0x2C9617CF507A56A4, 0xA98D9183CE8F7F72, 0x897D1ABC4722C458,
    0x8C2095A7469AD4C9, 0x727ADCFF687F71BE, 0x194AB054CA489688, 0x77E73B8719A18CBB,
    0x72F44171076C546B, 0x89025F3D02497003, 0x84A144628E3CC83F, 0x6585DCF5F41E78BE,
    0x71F517683A03C46B, 0x697F1EC520A87BC2, 0xEE9883A31F44BE0A, 0xA72C4DE71416CDC,
    0xCD78E1F5582350FF, 0x5979D3521D79A5A1, 0x37D2467B152A873C, 0x1841BC618CF70B1,
    0x6334744A20B7E775, 0x82A1DB0948F81547, 0xFA78A7ED1149C22C, 0x4AE92D45767FD7C8};
const fp p_minus_2 = {
    0xFFFFFFFFFFFFFFFD, 0xFFFFFFFFFFFFFFFF, 0xFFFFFFFFFFFFFFFF, 0xFFFFFFFFFFFFFFFF,
    0xFFFFFFFFFFFFFFFF, 0xFFFFFFFFFFFFFFFF, 0xFFFFFFFFFFFFFFFF, 0xFFFFFFFFFFFFFFFF,
    0xFFFFFFFFFFFFFFFF, 0xFFFFFFFFFFFFFFFF, 0xFFFFFFFFFFFFFFFF, 0xFFFFFFFFFFFFFFFF,
    0xFFFFFFFFFFFFFFFF, 0xFFFFFFFFFFFFFFFF, 0xFFFFFFFFFFFFFFFF, 0xFFFFFFFFFFFFFFFF,
    0xFFFFFFFFFFFFFFFF, 0xFFFFFFFFFFFFFFFF, 0xFFFFFFFFFFFFFFFF, 0xFFFFFFFFFFFFFFFF,
    0xFFFFFFFFFFFFFFFF, 0xFFFFFFFFFFFFFFFF, 0xFFFFFFFFFFFFFFFF, 0xFFFFFFFFFFFFFFFF,
    0xFFFFFFFFFFFFFFFF, 0xFFFFFFFFFFFFFFFF, 0xFFFFFFFFFFFFFFFF, 0xFFFFFFFFFFFFFFFF,
    0xFFFFFFFFFFFFFFFF, 0xFFFFFFFFFFFFFFFF, 0xFFFFFFFFFFFFFFFF, 0xFFFFFFFFFFFFFFFF,
    0xFFFFFFFFFFFFFFFF, 0xFFFFFFFFFFFFFFFF, 0xFFFFFFFFFFFFFFFF, 0xFFFFFFFFFFFFFFFF,
    0xFFFFFFFFFFFFFFFF, 0xFFFFFFFFFFFFFFFF, 0xFFFFFFFFFFFFFFFF, 0xFFFFFFFFFFFFFFFF,
    0xFFFFFFFFFFFFFFFF, 0xFFFFFFFFFFFFFFFF, 0xFFFFFFFFFFFFFFFF, 0xFFFFFFFFFFFFFFFF,
    0xFFFFFFFFFFFFFFFF, 0xFFFFFFFFFFFFFFFF, 0xFFFFFFFFFFFFFFFF, 0xFFFFFFFFFFFFFFFF,
    0xFFFFFFFFFFFFFFFF, 0xFFFFFFFFFFFFFFFF, 0xFFFFFFFFFFFFFFFF, 0xFFFFFFFFFFFFFFFF,
    0xFFFFFFFFFFFFFFFF, 0xFFFFFFFFFFFFFFFF, 0xFFFFFFFFFFFFFFFF, 0xFFFFFFFFFFFFFFFF,
    0xFFFFFFFFFFFFFFFF, 0xFFFFFFFFFFFFFFFF, 0xB1A73428FFFFFFFF, 0x3C7EA8E3C554965A,
    0x40803AF2FC159EF2, 0xCCFB305C48D4D505, 0x6B8EF3BD24FA010D, 0x2674B4838FAD59EB,
    0x5C175CC1BE876A7, 0xC5D744BAF4074152, 0x92C4B7DD1100ADFA, 0x274E59F92BD34D4D,
    0x3CF8373B1A6D448D, 0x41DF8B0B4F3E178B, 0x4EBFB033649A8012, 0xA4FC04DEB27F0F97,
    0x531B77E3E1EB32A2, 0x91707210201D3A74, 0x79DABE4D2F2A1E0F, 0x7837DAA51F59CDFA,
    0x91CBFF70AC345B5A, 0x25223E09B7BF27C4, 0x1D384E247A3FA6BD, 0x9A2FFACBA15A6110,
    0x92D9ECF65F9B3FD4, 0x6C0E75F1235909CE, 0xE3945BA3564DD650, 0x79A5B88C7FE6D95F,
    0xC83174128DC676F, 0x792C81C648CAB8CB, 0x12EBE4E03BCBD891, 0x251ACCA5A5EB867E,
    0x260DE537CDB28252, 0xF6F73F7357DD8F6E, 0x80480988522C5703, 0x1D8333732C8142B5,
    0x305E539F114AD8ED, 0xBB6D10EB0C6C11E5, 0x4C32EAB208C6E5CE, 0x4B52CCE89E8E10AA};
const fp inv_min_p_mod_r = {
    0x1, 0x0, 0x0, 0x0,
    0x0, 0x0, 0x0, 0x0,
    0x0, 0x0, 0x0, 0x0,
    0x0, 0x0, 0x0, 0x0,
    0x0, 0x0, 0x0, 0x0,
    0x0, 0x0, 0x0, 0x0,
    0x0, 0x0, 0x0, 0x0,
    0x0, 0x0, 0x0, 0x0,
    0x0, 0x0, 0x0, 0x0,
    0x0, 0x0, 0x0, 0x0,
    0x0, 0x0, 0x0, 0x0,
    0x0, 0x0, 0x0, 0x0,
    0x0, 0x0, 0x0, 0x0,
    0x0, 0x0, 0x0, 0x0,
    0x0, 0x0, 0xB1A7342900000000, 0x3C7EA8E3C554965A,
    0x40803AF2FC159EF2, 0xCCFB305C48D4D505, 0x6B8EF3BD24FA010D, 0x2674B4838FAD59EB,
    0x5C175CC1BE876A7, 0xC5D744BAF4074152, 0x92C4B7DD1100ADFA, 0x274E59F92BD34D4D,
    0x3CF8373B1A6D448D, 0x41DF8B0B4F3E178B, 0x4EBFB033649A8012, 0xA4FC04DEB27F0F97,
    0x531B77E3E1EB32A2, 0x91707210201D3A74, 0x79DABE4D2F2A1E0F, 0x7837DAA51F59CDFA,
    0x91CBFF70AC345B5A, 0x25223E09B7BF27C4, 0x1D384E247A3FA6BD, 0x9A2FFACBA15A6110,
    0x92D9ECF65F9B3FD4, 0x6C0E75F1235909CE, 0xE3945BA3564DD650, 0x79A5B88C7FE6D95F,
    0xC83174128DC676F, 0x792C81C648CAB8CB, 0x12EBE4E03BCBD891, 0x251ACCA5A5EB867E,
    0x260DE537CDB28252, 0xF6F73F7357DD8F6E, 0x80480988522C5703, 0x1D8333732C8142B5,
    0x305E539F114AD8ED, 0xBB6D10EB0C6C11E5, 0x4C32EAB208C6E5CE, 0x4B52CCE89E8E10AA};

#ifdef MONTGOMERY
const fp fp_1 = {
    0x3, 0x0, 0x0, 0x0,
    0x0, 0x0, 0x0, 0x0,
    0x0, 0x0, 0x0, 0x0,
    0x0, 0x0, 0x0, 0x0,
    0x0, 0x0, 0x0, 0x0,
    0x0, 0x0, 0x0, 0x0,
    0x0, 0x0, 0x0, 0x0,
    0x0, 0x0, 0x0, 0x0,
    0x0, 0x0, 0x0, 0x0,
    0x0, 0x0, 0x0, 0x0,
    0x0, 0x0, 0x0, 0x0,
    0x0, 0x0, 0x0, 0x0,
    0x0, 0x0, 0x0, 0x0,
    0x0, 0x0, 0x0, 0x0,
    0x0, 0x0, 0xEB0A638500000000, 0x4A840554B0023CEF,
    0x3E7F4F270BBF2329, 0x990E6EEB258180F0, 0xBD5324C89111FCD6, 0x8CA1E27550F7F23D,
    0xEEBB9E9BAC469C0A, 0xAE7A31CF23EA3C09, 0x47B1D868CCFDF60F, 0x8A14F2147C861817,
    0x49175A4EB0B83258, 0x3A615EDE1245B95E, 0x13C0EF65D2307FC9, 0x110BF163E882D13A,
    0x6AD98545A3E6818, 0x4BAEA9CF9FA850A3, 0x926FC5187281A5D1, 0x97587010A1F29610,
    0x4A9C01ADFB62EDF0, 0x909945E2D8C288B2, 0xA857159291410BC8, 0x31700F9D1BF0DCCF,
    0x4772391CE12E4082, 0xBBD49E2C95F4E294, 0x5542ED15FD167D0E, 0x930ED65A804B73E0,
    0xDA76BA3C856AC9B1, 0x947A7AAD259FD59E, 0xC73C515F4C9C764B, 0x90AF9A0F0E3D6C85,
    0x8DD6505896E87909, 0x1B1A41A5F86751B5, 0x7F27E367097AFAF4, 0xA77665A67A7C37DF,
    0x6EE50522CC1F7538, 0xCDB8CD3EDABBCA50, 0x1B673FE9E5AB4E93, 0x1E0799462455CE01};
const fp fp_2 = {
    0x6, 0x0, 0x0, 0x0,
    0x0, 0x0, 0x0, 0x0,
    0x0, 0x0, 0x0, 0x0,
    0x0, 0x0, 0x0, 0x0,
    0x0, 0x0, 0x0, 0x0,
    0x0, 0x0, 0x0, 0x0,
    0x0, 0x0, 0x0, 0x0,
    0x0, 0x0, 0x0, 0x0,
    0x0, 0x0, 0x0, 0x0,
    0x0, 0x0, 0x0, 0x0,
    0x0, 0x0, 0x0, 0x0,
    0x0, 0x0, 0x0, 0x0,
    0x0, 0x0, 0x0, 0x0,
    0x0, 0x0, 0x0, 0x0,
    0x0, 0x0, 0xd614c70a00000000, 0x95080aa9600479df,
    0x7cfe9e4e177e4652, 0x321cddd64b0301e0, 0x7aa649912223f9ad, 0x1943c4eaa1efe47b,
    0xdd773d37588d3815, 0x5cf4639e47d47813, 0x8f63b0d199fbec1f, 0x1429e428f90c302e,
    0x922eb49d617064b1, 0x74c2bdbc248b72bc, 0x2781decba460ff92, 0x2217e2c7d105a274,
    0x0d5b30a8b47cd030, 0x975d539f3f50a146, 0x24df8a30e5034ba2, 0x2eb0e02143e52c21,
    0x9538035bf6c5dbe1, 0x21328bc5b1851164, 0x50ae2b2522821791, 0x62e01f3a37e1b99f,
    0x8ee47239c25c8104, 0x77a93c592be9c528, 0xaa85da2bfa2cfa1d, 0x261dacb50096e7c0,
    0xb4ed74790ad59363, 0x28f4f55a4b3fab3d, 0x8e78a2be9938ec97, 0x215f341e1c7ad90b,
    0x1baca0b12dd0f213, 0x3634834bf0cea36b, 0xfe4fc6ce12f5f5e8, 0x4eeccb4cf4f86fbe,
    0xddca0a45983eea71, 0x9b719a7db57794a0, 0x36ce7fd3cb569d27, 0x3c0f328c48ab9c02};
#else
const fp fp_1 = {0x1};
const fp fp_2 = {0x2};
#endif

#define pbits 6143
#define itch_size 386

#elif defined P8191k332
const fp p = {
    0xFFFFFFFFFFFFFFFF, 0xFFFFFFFFFFFFFFFF, 0xFFFFFFFFFFFFFFFF, 0xFFFFFFFFFFFFFFFF,
    0xFFFFFFFFFFFFFFFF, 0xFFFFFFFFFFFFFFFF, 0xFFFFFFFFFFFFFFFF, 0xFFFFFFFFFFFFFFFF,
    0xFFFFFFFFFFFFFFFF, 0xFFFFFFFFFFFFFFFF, 0xFFFFFFFFFFFFFFFF, 0xFFFFFFFFFFFFFFFF,
    0xFFFFFFFFFFFFFFFF, 0xFFFFFFFFFFFFFFFF, 0xFFFFFFFFFFFFFFFF, 0xFFFFFFFFFFFFFFFF,
    0xFFFFFFFFFFFFFFFF, 0xFFFFFFFFFFFFFFFF, 0xFFFFFFFFFFFFFFFF, 0xFFFFFFFFFFFFFFFF,
    0xFFFFFFFFFFFFFFFF, 0xFFFFFFFFFFFFFFFF, 0xFFFFFFFFFFFFFFFF, 0xFFFFFFFFFFFFFFFF,
    0xFFFFFFFFFFFFFFFF, 0xFFFFFFFFFFFFFFFF, 0xFFFFFFFFFFFFFFFF, 0xFFFFFFFFFFFFFFFF,
    0xFFFFFFFFFFFFFFFF, 0xFFFFFFFFFFFFFFFF, 0xFFFFFFFFFFFFFFFF, 0xFFFFFFFFFFFFFFFF,
    0xFFFFFFFFFFFFFFFF, 0xFFFFFFFFFFFFFFFF, 0xFFFFFFFFFFFFFFFF, 0xFFFFFFFFFFFFFFFF,
    0xFFFFFFFFFFFFFFFF, 0xFFFFFFFFFFFFFFFF, 0xFFFFFFFFFFFFFFFF, 0xFFFFFFFFFFFFFFFF,
    0xFFFFFFFFFFFFFFFF, 0xFFFFFFFFFFFFFFFF, 0xFFFFFFFFFFFFFFFF, 0xFFFFFFFFFFFFFFFF,
    0xFFFFFFFFFFFFFFFF, 0xFFFFFFFFFFFFFFFF, 0xFFFFFFFFFFFFFFFF, 0xFFFFFFFFFFFFFFFF,
    0xFFFFFFFFFFFFFFFF, 0xFFFFFFFFFFFFFFFF, 0xFFFFFFFFFFFFFFFF, 0xFFFFFFFFFFFFFFFF,
    0xFFFFFFFFFFFFFFFF, 0xFFFFFFFFFFFFFFFF, 0xFFFFFFFFFFFFFFFF, 0xFFFFFFFFFFFFFFFF,
    0xFFFFFFFFFFFFFFFF, 0xFFFFFFFFFFFFFFFF, 0xFFFFFFFFFFFFFFFF, 0xFFFFFFFFFFFFFFFF,
    0xFFFFFFFFFFFFFFFF, 0xFFFFFFFFFFFFFFFF, 0xFFFFFFFFFFFFFFFF, 0xFFFFFFFFFFFFFFFF,
    0xFFFFFFFFFFFFFFFF, 0xFFFFFFFFFFFFFFFF, 0xFFFFFFFFFFFFFFFF, 0xFFFFFFFFFFFFFFFF,
    0xFFFFFFFFFFFFFFFF, 0xFFFFFFFFFFFFFFFF, 0xFFFFFFFFFFFFFFFF, 0xFFFFFFFFFFFFFFFF,
    0xFFFFFFFFFFFFFFFF, 0xFFFFFFFFFFFFFFFF, 0xFFFFFFFFFFFFFFFF, 0xFFFFFFFFFFFFFFFF,
    0xFFFFFFFFFFFFFFFF, 0xFFFFFFFFFFFFFFFF, 0x2E0621C764440174, 0x7BA474C239058CEF,
    0x537EC480CAD755EB, 0xF912CC03E2C4557B, 0xA178D4F608BEA75D, 0xE119A92CF4E2B8AE,
    0xF1B0A4948FC7120B, 0xF0C880F300C22C8D, 0x5828B0F84AAFB84, 0x21FB939984CFDC8C,
    0xFB768AD4226A2916, 0x6A2381351243DD2, 0x8DB838D149586257, 0x27CE2BE64CBDC9B6,
    0x4A0F74C0BCD7D54F, 0x2E4918A54BA2E2C0, 0x5D83CD758E3646E2, 0x34DE7732847B9C26,
    0xDB8B41875429D81, 0xAF603BF6CD784147, 0xEE043365EA3A993C, 0x53D6731D98FED8AD,
    0xE5A9167011DB3092, 0xFE225C377A7FF1C3, 0xC10F204742CB3572, 0xF54D43218402E0CD,
    0x9EBAA03BF78873D9, 0x7D78A167B9867DE4, 0x978A75239B4E7ACE, 0x6201DF9A8EB122CF,
    0xD3A893872A7F55D4, 0x46320E442C8BC50A, 0x7520D28F0F83361F, 0x693053A8DA54B933,
    0x36AC69423D5E6089, 0xB9C4C3192EE8844E, 0xA6ABF88ACF95B5C, 0x448B344EE77D5F46,
    0x5BCB51797AFAAFF1, 0xF0D0392D1336FCE6, 0x8912950385C91E7C, 0x331DFC0B2695D0AB,
    0xB471AEE5D6DE1CB9, 0x92DC9513AD93C2EA, 0x43C05D102BB20822, 0x82B9EA8D5F9D5A71,
    0x59A6F0CCD64A9363, 0x1BE4619762BF3D69, 0x38AC9C70136407D5, 0x45802B9C1FF4EE83};
const fp r_squared_mod_p = {
    0xC926CEA2AB7C683E, 0x1330755EABC1282E, 0x5ED311D80DF33EC4, 0xB3198C27A78E5A42,
    0xC09EB4EE7389FA4B, 0xACCBF2CEE5B0C3AF, 0x2577561707FAC499, 0x7B48392ECC6AD48F,
    0xFA82F70FECAAFC07, 0x1DF0B234B175FC7, 0xD0726E4251B9C3BE, 0xBB45DAE277943CD9,
    0x31A54106ACBD2872, 0x8104063C28288E5C, 0xDA1992A3B0D8738F, 0x999A10BECD79A3C8,
    0xA7AAB81724D6665C, 0x9ABAC819A94B51E2, 0xDAD72AC8349FD27, 0x5B87A7E2CCF45EC7,
    0x4AA7DCA416613CB4, 0xF3B2461D83DD7B4E, 0x533FEB1E9B1FA65A, 0x8BD5A5DBA13BE459,
    0xD64E81E47C535CF4, 0x1AB5FD3ACDFE9339, 0x2D59320CEAF3B43B, 0x42C00DCEBBB9196,
    0xC5BE417520838CD1, 0xFC267E879EA470FF, 0xF724860785E2AFCE, 0x3BC88FEE45F83E86,
    0xF26D007C98966BE3, 0xA76A275C784356CE, 0x585EE8CEEFE9AD9B, 0xA3155674D0610AD6,
    0x84771CFE7B124E51, 0xF3F47D4CDEA89881, 0xC8F81D1E9AB041BA, 0xE9975DA099DFF7A3,
    0xB36EBF2DFF39011A, 0xE0654B9C456CD2EF, 0x480720E94B47526B, 0x57CFACC9CC528A3C,
    0xE5BEBAF61E6B957D, 0x743634FC8EBCCDBC, 0xEB9D8B24B428574E, 0x49E5A493DBC12150,
    0x4E5EADE1E5DB3C7C, 0x90C4353A673CE2EE, 0x8CED65098CD62D65, 0xF4563DA0E996C255,
    0x39D8199FE7F46768, 0x74BE582657EC55AA, 0xF6D36C1016302E0E, 0x74E17EEC60F138DD,
    0xA89D70E85FA99D78, 0xA474283AE9937D47, 0xDB123DEFDBE8134A, 0x40C23980FCFAB5D3,
    0xC950673683A6CA71, 0xD092C0A8661BE07B, 0xBAAFB1152D5604F6, 0xCD57D77B8D8BF97B,
    0x1DA44253C8BC8F08, 0x45D528D1D70985BE, 0x1FDE3E1368AF6B1, 0xAF9562D75A1B88EB,
    0xB4C47B323AFA9A15, 0x8D8CC1CC96DC7755, 0x34CFD9E63E6ABCA9, 0x48FB4F670B813B9D,
    0xBE04B26D4B3253CB, 0xDE38C160CC914066, 0x143727BE19E01C05, 0x94A2EF801BF2ACFC,
    0x895815A079E41F27, 0x631924A86EC71160, 0xACAA3E6597A7FE90, 0xF38AF8C130DA73ED,
    0x6616EF4B9A4BCB7A, 0x762083E7FB509F37, 0xCF7C508EAF1FDB69, 0xFEA716AEA54F106F,
    0xD286EE2469346732, 0xC7C72A6FC60C6ACB, 0x326E04232565D6CA, 0xD2DC26F217F7B9BD,
    0x78D017156EF58E56, 0x29E16C2AA4E6200A, 0xDC04381040278841, 0x444A44727CFA3138,
    0x617CBCB43E32F6FB, 0xB886F4F1F544B2EB, 0x84EFE5A30E6CAB93, 0x7A3EEA68408DA311,
    0x96ACD0D337B66A12, 0xAA8AF2C9182E7415, 0x32B221B12BBAE0DA, 0x6E6CD8E25933F397,
    0xC916347926A158A3, 0x913751CB7CE1AD71, 0x7C946811A13FF787, 0x6F6C5AC9DE9DE7BB,
    0x99CF6A669E866D0F, 0x817FD58CB3492611, 0x787F1DF2EAF61A75, 0xD9A8FC0F8B60749,
    0xEA3DF24BD77CB11D, 0x6B780CE11D462E2B, 0xEA043B711C42FF7E, 0x9EDD27184604A9B2,
    0x88E57A20E275289E, 0xC5E09E5AFE3890C7, 0xC4A76A3B912CA7D6, 0xC0E59EE81AF2885C,
    0x859DCCCD3BBDBB03, 0x76C559128E852BB9, 0xD8FC084BE3522ACD, 0xCF85283D9C48AFB2,
    0x6863EAE3E7D882DB, 0xE6387ADDBD3D655F, 0x4FC02DD1107C9244, 0x8E94B0CC6C8EE116,
    0x5EA21DCBB1C09B84, 0x9383679ADF1653B8, 0x12DBC663BB6777E5, 0x38D5D572472DB5EF};
const fp p_minus_2 = {
    0xFFFFFFFFFFFFFFFD, 0xFFFFFFFFFFFFFFFF, 0xFFFFFFFFFFFFFFFF, 0xFFFFFFFFFFFFFFFF,
    0xFFFFFFFFFFFFFFFF, 0xFFFFFFFFFFFFFFFF, 0xFFFFFFFFFFFFFFFF, 0xFFFFFFFFFFFFFFFF,
    0xFFFFFFFFFFFFFFFF, 0xFFFFFFFFFFFFFFFF, 0xFFFFFFFFFFFFFFFF, 0xFFFFFFFFFFFFFFFF,
    0xFFFFFFFFFFFFFFFF, 0xFFFFFFFFFFFFFFFF, 0xFFFFFFFFFFFFFFFF, 0xFFFFFFFFFFFFFFFF,
    0xFFFFFFFFFFFFFFFF, 0xFFFFFFFFFFFFFFFF, 0xFFFFFFFFFFFFFFFF, 0xFFFFFFFFFFFFFFFF,
    0xFFFFFFFFFFFFFFFF, 0xFFFFFFFFFFFFFFFF, 0xFFFFFFFFFFFFFFFF, 0xFFFFFFFFFFFFFFFF,
    0xFFFFFFFFFFFFFFFF, 0xFFFFFFFFFFFFFFFF, 0xFFFFFFFFFFFFFFFF, 0xFFFFFFFFFFFFFFFF,
    0xFFFFFFFFFFFFFFFF, 0xFFFFFFFFFFFFFFFF, 0xFFFFFFFFFFFFFFFF, 0xFFFFFFFFFFFFFFFF,
    0xFFFFFFFFFFFFFFFF, 0xFFFFFFFFFFFFFFFF, 0xFFFFFFFFFFFFFFFF, 0xFFFFFFFFFFFFFFFF,
    0xFFFFFFFFFFFFFFFF, 0xFFFFFFFFFFFFFFFF, 0xFFFFFFFFFFFFFFFF, 0xFFFFFFFFFFFFFFFF,
    0xFFFFFFFFFFFFFFFF, 0xFFFFFFFFFFFFFFFF, 0xFFFFFFFFFFFFFFFF, 0xFFFFFFFFFFFFFFFF,
    0xFFFFFFFFFFFFFFFF, 0xFFFFFFFFFFFFFFFF, 0xFFFFFFFFFFFFFFFF, 0xFFFFFFFFFFFFFFFF,
    0xFFFFFFFFFFFFFFFF, 0xFFFFFFFFFFFFFFFF, 0xFFFFFFFFFFFFFFFF, 0xFFFFFFFFFFFFFFFF,
    0xFFFFFFFFFFFFFFFF, 0xFFFFFFFFFFFFFFFF, 0xFFFFFFFFFFFFFFFF, 0xFFFFFFFFFFFFFFFF,
    0xFFFFFFFFFFFFFFFF, 0xFFFFFFFFFFFFFFFF, 0xFFFFFFFFFFFFFFFF, 0xFFFFFFFFFFFFFFFF,
    0xFFFFFFFFFFFFFFFF, 0xFFFFFFFFFFFFFFFF, 0xFFFFFFFFFFFFFFFF, 0xFFFFFFFFFFFFFFFF,
    0xFFFFFFFFFFFFFFFF, 0xFFFFFFFFFFFFFFFF, 0xFFFFFFFFFFFFFFFF, 0xFFFFFFFFFFFFFFFF,
    0xFFFFFFFFFFFFFFFF, 0xFFFFFFFFFFFFFFFF, 0xFFFFFFFFFFFFFFFF, 0xFFFFFFFFFFFFFFFF,
    0xFFFFFFFFFFFFFFFF, 0xFFFFFFFFFFFFFFFF, 0xFFFFFFFFFFFFFFFF, 0xFFFFFFFFFFFFFFFF,
    0xFFFFFFFFFFFFFFFF, 0xFFFFFFFFFFFFFFFF, 0x2E0621C764440174, 0x7BA474C239058CEF,
    0x537EC480CAD755EB, 0xF912CC03E2C4557B, 0xA178D4F608BEA75D, 0xE119A92CF4E2B8AE,
    0xF1B0A4948FC7120B, 0xF0C880F300C22C8D, 0x5828B0F84AAFB84, 0x21FB939984CFDC8C,
    0xFB768AD4226A2916, 0x6A2381351243DD2, 0x8DB838D149586257, 0x27CE2BE64CBDC9B6,
    0x4A0F74C0BCD7D54F, 0x2E4918A54BA2E2C0, 0x5D83CD758E3646E2, 0x34DE7732847B9C26,
    0xDB8B41875429D81, 0xAF603BF6CD784147, 0xEE043365EA3A993C, 0x53D6731D98FED8AD,
    0xE5A9167011DB3092, 0xFE225C377A7FF1C3, 0xC10F204742CB3572, 0xF54D43218402E0CD,
    0x9EBAA03BF78873D9, 0x7D78A167B9867DE4, 0x978A75239B4E7ACE, 0x6201DF9A8EB122CF,
    0xD3A893872A7F55D4, 0x46320E442C8BC50A, 0x7520D28F0F83361F, 0x693053A8DA54B933,
    0x36AC69423D5E6089, 0xB9C4C3192EE8844E, 0xA6ABF88ACF95B5C, 0x448B344EE77D5F46,
    0x5BCB51797AFAAFF1, 0xF0D0392D1336FCE6, 0x8912950385C91E7C, 0x331DFC0B2695D0AB,
    0xB471AEE5D6DE1CB9, 0x92DC9513AD93C2EA, 0x43C05D102BB20822, 0x82B9EA8D5F9D5A71,
    0x59A6F0CCD64A9363, 0x1BE4619762BF3D69, 0x38AC9C70136407D5, 0x45802B9C1FF4EE83};
const fp inv_min_p_mod_r = {
    0x1, 0x0, 0x0, 0x0,
    0x0, 0x0, 0x0, 0x0,
    0x0, 0x0, 0x0, 0x0,
    0x0, 0x0, 0x0, 0x0,
    0x0, 0x0, 0x0, 0x0,
    0x0, 0x0, 0x0, 0x0,
    0x0, 0x0, 0x0, 0x0,
    0x0, 0x0, 0x0, 0x0,
    0x0, 0x0, 0x0, 0x0,
    0x0, 0x0, 0x0, 0x0,
    0x0, 0x0, 0x0, 0x0,
    0x0, 0x0, 0x0, 0x0,
    0x0, 0x0, 0x0, 0x0,
    0x0, 0x0, 0x0, 0x0,
    0x0, 0x0, 0x0, 0x0,
    0x0, 0x0, 0x0, 0x0,
    0x0, 0x0, 0x0, 0x0,
    0x0, 0x0, 0x0, 0x0,
    0x0, 0x0, 0x0, 0x0,
    0x0, 0x0, 0x2E0621C764440175, 0x7BA474C239058CEF,
    0x537EC480CAD755EB, 0xF912CC03E2C4557B, 0xA178D4F608BEA75D, 0xE119A92CF4E2B8AE,
    0xF1B0A4948FC7120B, 0xF0C880F300C22C8D, 0x5828B0F84AAFB84, 0x21FB939984CFDC8C,
    0xFB768AD4226A2916, 0x6A2381351243DD2, 0x8DB838D149586257, 0x27CE2BE64CBDC9B6,
    0x4A0F74C0BCD7D54F, 0x2E4918A54BA2E2C0, 0x5D83CD758E3646E2, 0x34DE7732847B9C26,
    0xDB8B41875429D81, 0xAF603BF6CD784147, 0xEE043365EA3A993C, 0x53D6731D98FED8AD,
    0xE5A9167011DB3092, 0xFE225C377A7FF1C3, 0xC10F204742CB3572, 0xF54D43218402E0CD,
    0x9EBAA03BF78873D9, 0x7D78A167B9867DE4, 0x978A75239B4E7ACE, 0x6201DF9A8EB122CF,
    0xD3A893872A7F55D4, 0x46320E442C8BC50A, 0x7520D28F0F83361F, 0x693053A8DA54B933,
    0x36AC69423D5E6089, 0xB9C4C3192EE8844E, 0xA6ABF88ACF95B5C, 0x448B344EE77D5F46,
    0x5BCB51797AFAAFF1, 0xF0D0392D1336FCE6, 0x8912950385C91E7C, 0x331DFC0B2695D0AB,
    0xB471AEE5D6DE1CB9, 0x92DC9513AD93C2EA, 0x43C05D102BB20822, 0x82B9EA8D5F9D5A71,
    0x59A6F0CCD64A9363, 0x1BE4619762BF3D69, 0x38AC9C70136407D5, 0x45802B9C1FF4EE83};

#ifdef MONTGOMERY
const fp fp_1 = {
    0x3, 0x0, 0x0, 0x0,
    0x0, 0x0, 0x0, 0x0,
    0x0, 0x0, 0x0, 0x0,
    0x0, 0x0, 0x0, 0x0,
    0x0, 0x0, 0x0, 0x0,
    0x0, 0x0, 0x0, 0x0,
    0x0, 0x0, 0x0, 0x0,
    0x0, 0x0, 0x0, 0x0,
    0x0, 0x0, 0x0, 0x0,
    0x0, 0x0, 0x0, 0x0,
    0x0, 0x0, 0x0, 0x0,
    0x0, 0x0, 0x0, 0x0,
    0x0, 0x0, 0x0, 0x0,
    0x0, 0x0, 0x0, 0x0,
    0x0, 0x0, 0x0, 0x0,
    0x0, 0x0, 0x0, 0x0,
    0x0, 0x0, 0x0, 0x0,
    0x0, 0x0, 0x0, 0x0,
    0x0, 0x0, 0x0, 0x0,
    0x0, 0x0, 0x75ED9AA9D333FBA1, 0x8D12A1B954EF5932,
    0x583B27D9F79FE3D, 0x14C79BF457B2FF8E, 0x1B95811DE5C409E6, 0x5CB304792157D5F4,
    0x2AEE124250AAC9DC, 0x2DA67D26FDB97A56, 0xEF785ED171FF0D71, 0x9A0D453371906A5B,
    0xD9C5F8398C184BD, 0xEC1957C60C934687, 0x56D7558C23F6D8FA, 0x88957C4D19C6A2DC,
    0x21D1A1BDC9788012, 0x7524B6101D1757BF, 0xE774979F555D2B59, 0x61649A68728D2B8C,
    0xD6D5E3B6A038277C, 0xF1DF4C1B97973C2A, 0x35F365CE41503449, 0x47CA6A7350375F6,
    0x4F04BCAFCA6E6E49, 0x598EB5990802AB4, 0xBCD29F2A379E5FA7, 0x2018369B73F75D96,
    0x23D01F4C1966A472, 0x87961BC8D36C8652, 0x3960A0952E148F94, 0xD9FA613053EC9791,
    0x8506456A8081FE82, 0x2D69D5337A5CB0DF, 0xA09D8852D1765DA2, 0xC46F05057101D465,
    0x5BFAC43947E4DE63, 0xD2B1B6B473467315, 0xE0BFC165F913EDE9, 0x325E63134987E22D,
    0xEC9E0B938F0FF02C, 0x2D8F5478C65B094C, 0x64C840F56EA4A489, 0x66A60BDE8C3E8DFD,
    0xE2AAF34E7B65A9D4, 0x476A40C4F744B73F, 0x34BEE8CF7CE9E798, 0x77D24057E127F0AC,
    0xF30B2D997D2045D5, 0xAC52DB39D7C247C3, 0x55FA2AAFC5D3E880, 0x2F7F7D2BA0213476};
const fp fp_2 = {
    0x7, 0x0, 0x0, 0x0,
    0x0, 0x0, 0x0, 0x0,
    0x0, 0x0, 0x0, 0x0,
    0x0, 0x0, 0x0, 0x0,
    0x0, 0x0, 0x0, 0x0,
    0x0, 0x0, 0x0, 0x0,
    0x0, 0x0, 0x0, 0x0,
    0x0, 0x0, 0x0, 0x0,
    0x0, 0x0, 0x0, 0x0,
    0x0, 0x0, 0x0, 0x0,
    0x0, 0x0, 0x0, 0x0,
    0x0, 0x0, 0x0, 0x0,
    0x0, 0x0, 0x0, 0x0,
    0x0, 0x0, 0x0, 0x0,
    0x0, 0x0, 0x0, 0x0,
    0x0, 0x0, 0x0, 0x0,
    0x0, 0x0, 0x0, 0x0,
    0x0, 0x0, 0x0, 0x0,
    0x0, 0x0, 0x0, 0x0,
    0x0, 0x0, 0xbdd5138c4223f5cd, 0x9e80ceb070d92575,
    0xb788a07a741ca68f, 0x307c6be4cca1a9a0, 0x95b22d45c2c96c6e, 0xd84c5fc54dccf339,
    0x642b7ff0118e81ac, 0x6a84795afab0c81e, 0xd96e32935f531f5d, 0x121ef6cd5e50f82b,
    0x1fc234330f18e065, 0xd1907778c8024f3b, 0x1ff67246fe954f9e, 0xe95cccb3e6cf7c02,
    0xf993cebad6192ad5, 0xbc00537aee8bccbd, 0x716561c91c840fd0, 0x8deabd9e609ebaf3,
    0x9ff31354cb2db177, 0x345e5c4061b6370e, 0x7de298369865cf57, 0xb522da30d108133e,
    0xb86062ef8301abff, 0x0d0f7a7ba68063a4, 0xb8961e0d2c7189db, 0x4ae32a1563ebda5f,
    0xa8e59e5c3b44d50a, 0x91b39629ed528ebf, 0xdb36cc06c0daa45a, 0x51f2e2c619280c52,
    0x3663f74dd684a731, 0x14a19c22c82d9cb4, 0xcc1a3e1693698525, 0x1fadb66207aeef97,
    0x81491f30526b5c3e, 0xeb9eaa4fb7a461dc, 0xb714c343452e8076, 0x203191d7ab926515,
    0x7d70c5ada3253067, 0x6a4e6fc4797f15b3, 0x407dece757802a95, 0x9a2e1bb1f1e74b4f,
    0x10e437b71fed36ef, 0xfbf7ec7640f5ab95, 0x25bd748ece21c70d, 0x6cea962262b286e7,
    0x8c6f6a6623f5f847, 0x3cc154dc4cc5521e, 0x7347b8ef7843c92c, 0x197ecebb204d7a69};
#else
const fp fp_1 = {0x1};
const fp fp_2 = {0x2};
#endif

#define pbits 8191
#define itch_size 516

#elif defined P9215k384
const fp p = {
    0xFFFFFFFFFFFFFFFF, 0xFFFFFFFFFFFFFFFF, 0xFFFFFFFFFFFFFFFF, 0xFFFFFFFFFFFFFFFF,
    0xFFFFFFFFFFFFFFFF, 0xFFFFFFFFFFFFFFFF, 0xFFFFFFFFFFFFFFFF, 0xFFFFFFFFFFFFFFFF,
    0xFFFFFFFFFFFFFFFF, 0xFFFFFFFFFFFFFFFF, 0xFFFFFFFFFFFFFFFF, 0xFFFFFFFFFFFFFFFF,
    0xFFFFFFFFFFFFFFFF, 0xFFFFFFFFFFFFFFFF, 0xFFFFFFFFFFFFFFFF, 0xFFFFFFFFFFFFFFFF,
    0xFFFFFFFFFFFFFFFF, 0xFFFFFFFFFFFFFFFF, 0xFFFFFFFFFFFFFFFF, 0xFFFFFFFFFFFFFFFF,
    0xFFFFFFFFFFFFFFFF, 0xFFFFFFFFFFFFFFFF, 0xFFFFFFFFFFFFFFFF, 0xFFFFFFFFFFFFFFFF,
    0xFFFFFFFFFFFFFFFF, 0xFFFFFFFFFFFFFFFF, 0xFFFFFFFFFFFFFFFF, 0xFFFFFFFFFFFFFFFF,
    0xFFFFFFFFFFFFFFFF, 0xFFFFFFFFFFFFFFFF, 0xFFFFFFFFFFFFFFFF, 0xFFFFFFFFFFFFFFFF,
    0xFFFFFFFFFFFFFFFF, 0xFFFFFFFFFFFFFFFF, 0xFFFFFFFFFFFFFFFF, 0xFFFFFFFFFFFFFFFF,
    0xFFFFFFFFFFFFFFFF, 0xFFFFFFFFFFFFFFFF, 0xFFFFFFFFFFFFFFFF, 0xFFFFFFFFFFFFFFFF,
    0xFFFFFFFFFFFFFFFF, 0xFFFFFFFFFFFFFFFF, 0xFFFFFFFFFFFFFFFF, 0xFFFFFFFFFFFFFFFF,
    0xFFFFFFFFFFFFFFFF, 0xFFFFFFFFFFFFFFFF, 0xFFFFFFFFFFFFFFFF, 0xFFFFFFFFFFFFFFFF,
    0xFFFFFFFFFFFFFFFF, 0xFFFFFFFFFFFFFFFF, 0xFFFFFFFFFFFFFFFF, 0xFFFFFFFFFFFFFFFF,
    0xFFFFFFFFFFFFFFFF, 0xFFFFFFFFFFFFFFFF, 0xFFFFFFFFFFFFFFFF, 0xFFFFFFFFFFFFFFFF,
    0xFFFFFFFFFFFFFFFF, 0xFFFFFFFFFFFFFFFF, 0xFFFFFFFFFFFFFFFF, 0xFFFFFFFFFFFFFFFF,
    0xFFFFFFFFFFFFFFFF, 0xFFFFFFFFFFFFFFFF, 0xFFFFFFFFFFFFFFFF, 0xFFFFFFFFFFFFFFFF,
    0xFFFFFFFFFFFFFFFF, 0xFFFFFFFFFFFFFFFF, 0xFFFFFFFFFFFFFFFF, 0xFFFFFFFFFFFFFFFF,
    0xFFFFFFFFFFFFFFFF, 0xFFFFFFFFFFFFFFFF, 0xFFFFFFFFFFFFFFFF, 0xFFFFFFFFFFFFFFFF,
    0xFFFFFFFFFFFFFFFF, 0xFFFFFFFFFFFFFFFF, 0xFFFFFFFFFFFFFFFF, 0xFFFFFFFFFFFFFFFF,
    0xFFFFFFFFFFFFFFFF, 0xFFFFFFFFFFFFFFFF, 0xFFFFFFFFFFFFFFFF, 0xFFFFFFFFFFFFFFFF,
    0xFFFFFFFFFFFFFFFF, 0xFFFFFFFFFFFFFFFF, 0xFFFFFFFFFFFFFFFF, 0xFFFFFFFFFFFFFFFF,
    0x2EC17140FFFFFFFF, 0x58829A4749BFA0D2, 0x6E1C47467499D375, 0xA433ACAE72C1D8B4,
    0xCF5CD95CE82A5C14, 0xE60DBDFAB3FFD04C, 0x3671B6B3CD0F7E58, 0x6BD02B7FCE0F4E75,
    0x90F24807B4B7AF9C, 0x4F2CEC0CE0241B0F, 0xDAE4AB0857A44847, 0xDA2831EE87CBE75D,
    0xE72FAF27764E4CBE, 0xAAF62C413E6E47F1, 0xBBFFC6E78DBC2DA3, 0x4FA19216246934D0,
    0x53D89CE34FC62BD1, 0xC08ACE12CF11F198, 0xA42FA468F0346202, 0xF3A1ACE18417AB2F,
    0xFB69D6E1F8AB9389, 0x233F0419F2F959C2, 0x40B2D4DD4B30387A, 0xA84638104A9AB888,
    0xCA0CC59ECE014F78, 0xD3997F280FF40CAD, 0x80FC6D8B97015D3E, 0x1F4BE77FEBBA6733,
    0xF1DD3386AC13F6A7, 0xD6544289E2B3ACD6, 0x2E4EBAA44BF213A5, 0xD231097E09FE98FD,
    0xC69C26AC0032FE40, 0x520C24A33C2A46C7, 0x5E1BCDC39F4C8B8F, 0x5559A516CBF6D850,
    0x6AD4A3E4198B3C5C, 0x38022E0311F218E8, 0xF3264C72939C7E55, 0x3C0DF145B5BD51BC,
    0x628A478FA5124829, 0x7E5FA4319C3877A, 0xAE8B7D05A9A30981, 0x5977AC2CACE90F15,
    0xD8ECFCBDE4D6B71, 0xA96937DC65C53548, 0xA9255F2DFFEF2A9D, 0x1B9060660751B405,
    0x9777AC37E208F29A, 0xE021AAC821B5FD14, 0x4363CFAF112793A5, 0x3419DCB6AFDA0E09,
    0x3AFFEC566C311E95, 0xD1E15EDCCC3EA709, 0x9D000E8C5EE1B5B6, 0x8FC1951A0B63AA28,
    0xE74515E327C95380, 0x15281C20EF5E3B77, 0xE841E5F92AE94C9C, 0x4D0DD48D039DE3A7};

const fp r_squared_mod_p = {
    0xA708296D560DD189, 0xD515B5C1AE800359, 0xC74294870683E042, 0xC42F674E1F34CFFE,
    0xF79B8AC9918D4E96, 0xB70ADAC399A6E36D, 0xD679B683432D2B1D, 0x70F30943FC67AB02,
    0x6E7867D68C963D33, 0xD1D3D9C203C5A80B, 0xBF518EA2FC3614C8, 0x8FC850B2ED2BA6A4,
    0x8E1C32515EF3ADCC, 0x145F2CC51FEEC3C0, 0xEBB957F97CEFBF20, 0xFB2878A50F999333,
    0x90714BB387EB2BC7, 0xF9A9D54958A98D1A, 0x9440CF6F40053B61, 0xCFE7E0F97939EC73,
    0x7A2DD3A8B9222374, 0xE798E08AB71679CC, 0x3FF5E99F8666B2FC, 0x3B301C5639496077,
    0x4F639E4EBE906EFB, 0x4396CBB47537C9E2, 0x147A4D94EC7A55A0, 0xC10E3E15E333884,
    0x678507FC23DB3AA7, 0x8BE862CA6A73261B, 0x4CCCF2D95B90CA51, 0xEC4FAEE13E89FB68,
    0x1BB1AC0BA1DCEB52, 0xC8FE8498F39F8A49, 0xAE36F7DE4820EDE5, 0xAE9D4E0B694A19EE,
    0x2EB00564C3027459, 0x90E0D609EE4BDE8F, 0x9F4A342CD86C9C45, 0x1DA068C41CF56381,
    0x826DE08E5C24724B, 0xB66F55A29FA5E09D, 0x9444130CC58AC38C, 0xF42D0B2A9D250179,
    0xC5074170A601524F, 0x2D6F335D6D9320AD, 0xBEFE3FCAE232F088, 0xB26A4491AA272EBB,
    0x1DAA13F6F744105E, 0xD251ABF54711275C, 0x50F6CAF57E27B3CB, 0x5CC5F3FD4244932B,
    0x179B6E5CF34AF100, 0x16C5896AB56EAE4, 0x10CE0745D2B280CA, 0x9A30B307ADAC5AE3,
    0x7056CF1EDA32BF68, 0x35B1BC4D04566349, 0x5BB85509921F0656, 0xEFF5B6B64CBC7713,
    0x3ADF1AC7F89D4C12, 0xF5D16CDCD2D986AD, 0xB257C03FE2B88A5A, 0x1462E40B7C0E3E52,
    0x748B6387CE47AF5B, 0x3EAC3ECB4118037B, 0x9D68FD0E1C2DBDB9, 0xD8D9577E445F4D23,
    0x59745B292566FF6B, 0x7DC63BCB9519B843, 0x3E053C743647EE5B, 0xD0681F2680CCF081,
    0x25912B48B9B4779D, 0x33DAC58D8CB67376, 0xC4A0EAD838FB9409, 0xD6378FF883021AC8,
    0x33463B5D0EFA4EC3, 0x49E4FC4D3AB22AEC, 0xB74160FE2AE71196, 0x29F571F370AD7F83,
    0x4F73E74410AF5C17, 0xD2801E5A5107DC96, 0x1B53362E66740DA9, 0xD2B3813621B9FD34,
    0x387DD2072D218E68, 0x9C8F9B0CF47E0524, 0xAE1D312A09550E6E, 0x741AF7FEEFC104B3,
    0x36FAE0B279F279B5, 0x6C6886F04C634C6A, 0x110D2D959DAF6354, 0x30B1F492C83E2023,
    0x84994F53BEAB5F3A, 0x99E69D00852B4FD6, 0x9F279A3869DE39A3, 0xF1D34839CD6EA879,
    0x6682E28E7BAB0ED9, 0x6BD7F6B14063434A, 0x818E00EF2180F31B, 0x2A61456C836D61F7,
    0x5E36F2E1086B5F87, 0xCEE7D24729003E7E, 0x6116799D93F76F25, 0x833786E931E10865,
    0xF8D2BDAEB73E9756, 0x2C0D78688924EA7, 0x36981CB3F2B4D3E9, 0xE913F0AA0AC3D2E2,
    0x244B1D60D83BCCFF, 0xCFE5CFC9D9BA7433, 0x59E0D5C898FB7333, 0x6059EBD482A7DEA6,
    0x6EBBD8F0888E30A2, 0xFA232549A8B7D707, 0x53351D6E9AD3ABF3, 0xB32412345FAFEAF2,
    0xEDA5DE5F2C2B41D4, 0xC48A702536DFEF85, 0x879AE9AC25816AD4, 0x91FAA007AD6490F3,
    0xA139A7FEB9AB8E30, 0xEDFE21F218E538E8, 0x9EDB6B18BE8064AE, 0x7EE0D94FA468AAA1,
    0xF839EDCD72458FFB, 0x575F4852FECB8331, 0x199B1436FD67F24D, 0xEF0EEBF68B466FC0,
    0x42FD785969EEC8E8, 0xE1AFA153FA20EA50, 0x815E079B329B38D6, 0xD81631BFA3EB4FE3,
    0x6C661667DD512024, 0x14E80A751C435428, 0xABC8064CB617D9AD, 0x524587D9B6A0F667,
    0x475B867DDE78650C, 0xF1051D5F83D30F3, 0xD108D0A79C184F26, 0xC316C051CC3168C,
    0x4CDAC44F2C715830, 0xFF98DF0FFEAFBBA5, 0x68755ECF81901860, 0x3B2956EA9DAD8B39};

const fp p_minus_2 = {
    0xFFFFFFFFFFFFFFFD, 0xFFFFFFFFFFFFFFFF, 0xFFFFFFFFFFFFFFFF, 0xFFFFFFFFFFFFFFFF,
    0xFFFFFFFFFFFFFFFF, 0xFFFFFFFFFFFFFFFF, 0xFFFFFFFFFFFFFFFF, 0xFFFFFFFFFFFFFFFF,
    0xFFFFFFFFFFFFFFFF, 0xFFFFFFFFFFFFFFFF, 0xFFFFFFFFFFFFFFFF, 0xFFFFFFFFFFFFFFFF,
    0xFFFFFFFFFFFFFFFF, 0xFFFFFFFFFFFFFFFF, 0xFFFFFFFFFFFFFFFF, 0xFFFFFFFFFFFFFFFF,
    0xFFFFFFFFFFFFFFFF, 0xFFFFFFFFFFFFFFFF, 0xFFFFFFFFFFFFFFFF, 0xFFFFFFFFFFFFFFFF,
    0xFFFFFFFFFFFFFFFF, 0xFFFFFFFFFFFFFFFF, 0xFFFFFFFFFFFFFFFF, 0xFFFFFFFFFFFFFFFF,
    0xFFFFFFFFFFFFFFFF, 0xFFFFFFFFFFFFFFFF, 0xFFFFFFFFFFFFFFFF, 0xFFFFFFFFFFFFFFFF,
    0xFFFFFFFFFFFFFFFF, 0xFFFFFFFFFFFFFFFF, 0xFFFFFFFFFFFFFFFF, 0xFFFFFFFFFFFFFFFF,
    0xFFFFFFFFFFFFFFFF, 0xFFFFFFFFFFFFFFFF, 0xFFFFFFFFFFFFFFFF, 0xFFFFFFFFFFFFFFFF,
    0xFFFFFFFFFFFFFFFF, 0xFFFFFFFFFFFFFFFF, 0xFFFFFFFFFFFFFFFF, 0xFFFFFFFFFFFFFFFF,
    0xFFFFFFFFFFFFFFFF, 0xFFFFFFFFFFFFFFFF, 0xFFFFFFFFFFFFFFFF, 0xFFFFFFFFFFFFFFFF,
    0xFFFFFFFFFFFFFFFF, 0xFFFFFFFFFFFFFFFF, 0xFFFFFFFFFFFFFFFF, 0xFFFFFFFFFFFFFFFF,
    0xFFFFFFFFFFFFFFFF, 0xFFFFFFFFFFFFFFFF, 0xFFFFFFFFFFFFFFFF, 0xFFFFFFFFFFFFFFFF,
    0xFFFFFFFFFFFFFFFF, 0xFFFFFFFFFFFFFFFF, 0xFFFFFFFFFFFFFFFF, 0xFFFFFFFFFFFFFFFF,
    0xFFFFFFFFFFFFFFFF, 0xFFFFFFFFFFFFFFFF, 0xFFFFFFFFFFFFFFFF, 0xFFFFFFFFFFFFFFFF,
    0xFFFFFFFFFFFFFFFF, 0xFFFFFFFFFFFFFFFF, 0xFFFFFFFFFFFFFFFF, 0xFFFFFFFFFFFFFFFF,
    0xFFFFFFFFFFFFFFFF, 0xFFFFFFFFFFFFFFFF, 0xFFFFFFFFFFFFFFFF, 0xFFFFFFFFFFFFFFFF,
    0xFFFFFFFFFFFFFFFF, 0xFFFFFFFFFFFFFFFF, 0xFFFFFFFFFFFFFFFF, 0xFFFFFFFFFFFFFFFF,
    0xFFFFFFFFFFFFFFFF, 0xFFFFFFFFFFFFFFFF, 0xFFFFFFFFFFFFFFFF, 0xFFFFFFFFFFFFFFFF,
    0xFFFFFFFFFFFFFFFF, 0xFFFFFFFFFFFFFFFF, 0xFFFFFFFFFFFFFFFF, 0xFFFFFFFFFFFFFFFF,
    0xFFFFFFFFFFFFFFFF, 0xFFFFFFFFFFFFFFFF, 0xFFFFFFFFFFFFFFFF, 0xFFFFFFFFFFFFFFFF,
    0x2EC17140FFFFFFFF, 0x58829A4749BFA0D2, 0x6E1C47467499D375, 0xA433ACAE72C1D8B4,
    0xCF5CD95CE82A5C14, 0xE60DBDFAB3FFD04C, 0x3671B6B3CD0F7E58, 0x6BD02B7FCE0F4E75,
    0x90F24807B4B7AF9C, 0x4F2CEC0CE0241B0F, 0xDAE4AB0857A44847, 0xDA2831EE87CBE75D,
    0xE72FAF27764E4CBE, 0xAAF62C413E6E47F1, 0xBBFFC6E78DBC2DA3, 0x4FA19216246934D0,
    0x53D89CE34FC62BD1, 0xC08ACE12CF11F198, 0xA42FA468F0346202, 0xF3A1ACE18417AB2F,
    0xFB69D6E1F8AB9389, 0x233F0419F2F959C2, 0x40B2D4DD4B30387A, 0xA84638104A9AB888,
    0xCA0CC59ECE014F78, 0xD3997F280FF40CAD, 0x80FC6D8B97015D3E, 0x1F4BE77FEBBA6733,
    0xF1DD3386AC13F6A7, 0xD6544289E2B3ACD6, 0x2E4EBAA44BF213A5, 0xD231097E09FE98FD,
    0xC69C26AC0032FE40, 0x520C24A33C2A46C7, 0x5E1BCDC39F4C8B8F, 0x5559A516CBF6D850,
    0x6AD4A3E4198B3C5C, 0x38022E0311F218E8, 0xF3264C72939C7E55, 0x3C0DF145B5BD51BC,
    0x628A478FA5124829, 0x7E5FA4319C3877A, 0xAE8B7D05A9A30981, 0x5977AC2CACE90F15,
    0xD8ECFCBDE4D6B71, 0xA96937DC65C53548, 0xA9255F2DFFEF2A9D, 0x1B9060660751B405,
    0x9777AC37E208F29A, 0xE021AAC821B5FD14, 0x4363CFAF112793A5, 0x3419DCB6AFDA0E09,
    0x3AFFEC566C311E95, 0xD1E15EDCCC3EA709, 0x9D000E8C5EE1B5B6, 0x8FC1951A0B63AA28,
    0xE74515E327C95380, 0x15281C20EF5E3B77, 0xE841E5F92AE94C9C, 0x4D0DD48D039DE3A7};

const fp inv_min_p_mod_r = {
    0x1, 0x0, 0x0, 0x0,
    0x0, 0x0, 0x0, 0x0,
    0x0, 0x0, 0x0, 0x0,
    0x0, 0x0, 0x0, 0x0,
    0x0, 0x0, 0x0, 0x0,
    0x0, 0x0, 0x0, 0x0,
    0x0, 0x0, 0x0, 0x0,
    0x0, 0x0, 0x0, 0x0,
    0x0, 0x0, 0x0, 0x0,
    0x0, 0x0, 0x0, 0x0,
    0x0, 0x0, 0x0, 0x0,
    0x0, 0x0, 0x0, 0x0,
    0x0, 0x0, 0x0, 0x0,
    0x0, 0x0, 0x0, 0x0,
    0x0, 0x0, 0x0, 0x0,
    0x0, 0x0, 0x0, 0x0,
    0x0, 0x0, 0x0, 0x0,
    0x0, 0x0, 0x0, 0x0,
    0x0, 0x0, 0x0, 0x0,
    0x0, 0x0, 0x0, 0x0,
    0x0, 0x0, 0x0, 0x0,
    0x2EC1714100000000, 0x58829A4749BFA0D2, 0x6E1C47467499D375, 0xA433ACAE72C1D8B4,
    0xCF5CD95CE82A5C14, 0xE60DBDFAB3FFD04C, 0x3671B6B3CD0F7E58, 0x6BD02B7FCE0F4E75,
    0x90F24807B4B7AF9C, 0x4F2CEC0CE0241B0F, 0xDAE4AB0857A44847, 0xDA2831EE87CBE75D,
    0xE72FAF27764E4CBE, 0xAAF62C413E6E47F1, 0xBBFFC6E78DBC2DA3, 0x4FA19216246934D0,
    0x53D89CE34FC62BD1, 0xC08ACE12CF11F198, 0xA42FA468F0346202, 0xF3A1ACE18417AB2F,
    0xFB69D6E1F8AB9389, 0x233F0419F2F959C2, 0x40B2D4DD4B30387A, 0xA84638104A9AB888,
    0xCA0CC59ECE014F78, 0xD3997F280FF40CAD, 0x80FC6D8B97015D3E, 0x1F4BE77FEBBA6733,
    0xF1DD3386AC13F6A7, 0xD6544289E2B3ACD6, 0x2E4EBAA44BF213A5, 0xD231097E09FE98FD,
    0xC69C26AC0032FE40, 0x520C24A33C2A46C7, 0x5E1BCDC39F4C8B8F, 0x5559A516CBF6D850,
    0x6AD4A3E4198B3C5C, 0x38022E0311F218E8, 0xF3264C72939C7E55, 0x3C0DF145B5BD51BC,
    0x628A478FA5124829, 0x7E5FA4319C3877A, 0xAE8B7D05A9A30981, 0x5977AC2CACE90F15,
    0xD8ECFCBDE4D6B71, 0xA96937DC65C53548, 0xA9255F2DFFEF2A9D, 0x1B9060660751B405,
    0x9777AC37E208F29A, 0xE021AAC821B5FD14, 0x4363CFAF112793A5, 0x3419DCB6AFDA0E09,
    0x3AFFEC566C311E95, 0xD1E15EDCCC3EA709, 0x9D000E8C5EE1B5B6, 0x8FC1951A0B63AA28,
    0xE74515E327C95380, 0x15281C20EF5E3B77, 0xE841E5F92AE94C9C, 0x4D0DD48D039DE3A7};

#ifdef MONTGOMERY
const fp fp_1 = {
    0x3, 0x0, 0x0, 0x0,
    0x0, 0x0, 0x0, 0x0,
    0x0, 0x0, 0x0, 0x0,
    0x0, 0x0, 0x0, 0x0,
    0x0, 0x0, 0x0, 0x0,
    0x0, 0x0, 0x0, 0x0,
    0x0, 0x0, 0x0, 0x0,
    0x0, 0x0, 0x0, 0x0,
    0x0, 0x0, 0x0, 0x0,
    0x0, 0x0, 0x0, 0x0,
    0x0, 0x0, 0x0, 0x0,
    0x0, 0x0, 0x0, 0x0,
    0x0, 0x0, 0x0, 0x0,
    0x0, 0x0, 0x0, 0x0,
    0x0, 0x0, 0x0, 0x0,
    0x0, 0x0, 0x0, 0x0,
    0x0, 0x0, 0x0, 0x0,
    0x0, 0x0, 0x0, 0x0,
    0x0, 0x0, 0x0, 0x0,
    0x0, 0x0, 0x0, 0x0,
    0x0, 0x0, 0x0, 0x0,
    0x73BBAC3D00000000, 0xF678312A22C11D89, 0xB5AB2A2CA232859F, 0x1364F9F4A7BA75E2,
    0x91E973E94780EBC2, 0x4DD6C60FE4008F19, 0x5CAADBE498D184F5, 0xBC8F7D8095D214A0,
    0x4D2927E8E1D8F12A, 0x12793BD95F93AED1, 0x6F51FEE6F913272A, 0x71876A34689C49E6,
    0x4A70F2899D1519C3, 0xFF1D7B3C44B5282A, 0xCC00AB4956CB7714, 0x111B49BD92C4618D,
    0x476295610AD7C8C, 0xBE5F95C792CA2B37, 0x137112C52F62D9F7, 0x251AF95B73B8FE71,
    0xDC27B5A15FD4562, 0x9642F3B22713F2B7, 0x3DE781681E6F5691, 0x72D57CF202FD667,
    0xA1D9AF2395FC1196, 0x85338287D023D9F6, 0x7D0AB75D3AFBE843, 0xA21C49803CD0CA65,
    0x2A68656BFBC41C0A, 0x7D03386257E4F97B, 0x7513D0131C29C50E, 0x896CE385E2043508,
    0xAC2B8BFBFF67053D, 0x9DB92164B812BA8, 0xE5AC96B5221A5D52, 0xFFF310BB9C1B770E,
    0xBF821453B35E4AEA, 0x57F975F6CA29B546, 0x268D1AA8452A8500, 0x4BD62C2EDEC80AC9,
    0xD861295110C92784, 0xE84E1136B2B56990, 0xF45D88EF0316E37C, 0xF398FB79F944D2BE,
    0xD753909C6517BDAB, 0x3C4586ACEB06027, 0x48FE27600328027, 0xAD4EDECDEA0AE3EF,
    0x3998FB5859E52831, 0x5F9AFFA79ADE08C2, 0x35D490F2CC89450E, 0x63B269DBF071D5E4,
    0x4F003AFCBB6CA440, 0x8A5BE3699B440AE4, 0x28FFD45AE35ADEDB, 0x50BB40B1DDD50186,
    0x4A30BE5688A4057E, 0xC087AB9D31E54D98, 0x473A4E147F441A2B, 0x18D68258F5265508};
const fp fp_2 = {
    0x6, 0x0, 0x0, 0x0,
    0x0, 0x0, 0x0, 0x0,
    0x0, 0x0, 0x0, 0x0,
    0x0, 0x0, 0x0, 0x0,
    0x0, 0x0, 0x0, 0x0,
    0x0, 0x0, 0x0, 0x0,
    0x0, 0x0, 0x0, 0x0,
    0x0, 0x0, 0x0, 0x0,
    0x0, 0x0, 0x0, 0x0,
    0x0, 0x0, 0x0, 0x0,
    0x0, 0x0, 0x0, 0x0,
    0x0, 0x0, 0x0, 0x0,
    0x0, 0x0, 0x0, 0x0,
    0x0, 0x0, 0x0, 0x0,
    0x0, 0x0, 0x0, 0x0,
    0x0, 0x0, 0x0, 0x0,
    0x0, 0x0, 0x0, 0x0,
    0x0, 0x0, 0x0, 0x0,
    0x0, 0x0, 0x0, 0x0,
    0x0, 0x0, 0x0, 0x0,
    0x0, 0x0, 0x0, 0x0,
    0xe777587a00000000, 0xecf0625445823b12, 0x6b56545944650b3f, 0x26c9f3e94f74ebc5,
    0x23d2e7d28f01d784, 0x9bad8c1fc8011e33, 0xb955b7c931a309ea, 0x791efb012ba42940,
    0x9a524fd1c3b1e255, 0x24f277b2bf275da2, 0xdea3fdcdf2264e54, 0xe30ed468d13893cc,
    0x94e1e5133a2a3386, 0xfe3af678896a5054, 0x98015692ad96ee29, 0x2236937b2588c31b,
    0x08ec52ac215af918, 0x7cbf2b8f2594566e, 0x26e2258a5ec5b3ef, 0x4a35f2b6e771fce2,
    0x1b84f6b42bfa8ac4, 0x2c85e7644e27e56e, 0x7bcf02d03cdead23, 0x0e5aaf9e405facce,
    0x43b35e472bf8232c, 0x0a67050fa047b3ed, 0xfa156eba75f7d087, 0x4438930079a194ca,
    0x54d0cad7f7883815, 0xfa0670c4afc9f2f6, 0xea27a02638538a1c, 0x12d9c70bc4086a10,
    0x585717f7fece0a7b, 0x13b7242c97025751, 0xcb592d6a4434baa4, 0xffe621773836ee1d,
    0x7f0428a766bc95d5, 0xaff2ebed94536a8d, 0x4d1a35508a550a00, 0x97ac585dbd901592,
    0xb0c252a221924f08, 0xd09c226d656ad321, 0xe8bb11de062dc6f9, 0xe731f6f3f289a57d,
    0xaea72138ca2f7b57, 0x0788b0d59d60c04f, 0x091fc4ec0065004e, 0x5a9dbd9bd415c7de,
    0x7331f6b0b3ca5063, 0xbf35ff4f35bc1184, 0x6ba921e599128a1c, 0xc764d3b7e0e3abc8,
    0x9e0075f976d94880, 0x14b7c6d3368815c8, 0x51ffa8b5c6b5bdb7, 0xa1768163bbaa030c,
    0x94617cad11480afc, 0x810f573a63ca9b30, 0x8e749c28fe883457, 0x31ad04b1ea4caa10};
#else
const fp fp_1 = {0x1};
const fp fp_2 = {0x2};
#endif
#define pbits 9215
#define itch_size 578

#endif

/*
AVX2 STUFF ##########################
*/

// static inline void add_80x80_avx2_C(fp v_c, const fp v_a, const fp v_b)
// {
//     for (int i = 0; i < 16; i++)
//     {
//         v_c[i] = _mm256_add_epi32(v_a[i], v_b[i]);
//     }
// }

// static inline void sub_80x80_avx2_C(__m256i *v_c, const __m256i *v_a, const __m256i *v_b)
// {
//     for (int i = 0; i < 16; i++)
//     {
//         v_c[i] = _mm256_sub_epi32(v_a[i], v_b[i]);
//     }
// }

static inline void convert4Karatsuba(int32_t *result, const int32_t *input, uint16_t length)
{
    int j = 0;
    for (int i = 0; i < length; i++)
    {
        result[i] = input[j];
        if ((i > 0) & ((i + 7) % 16 == 0))
            i = i + 6;
        j++;
    }
}

static inline void convertFromKarastuba(int32_t *result, const int32_t *input, uint16_t length)
{
    int j = 0;
    for (int i = 0; i < length; i++)
    {
        result[j] = input[i];
        if ((i > 0) & ((i + 7) % 16 == 0))
            i = i + 6;
        j++;
    }
}

static inline void mult_80x80_avx2_C(int32_t *v_result, const fp a, const fp b)
{

    // __m256i v_aux[24];
    int32_t v_aux[24 * 8] __attribute__((aligned(32))) = {0};
    int32_t v_aux1[24 * 8] __attribute__((aligned(32))) = {0};
    int32_t mmrA10[10 * 8] __attribute__((aligned(32))) = {0};
    int32_t mmrB10[10 * 8] __attribute__((aligned(32))) = {0};
    int64_t mmrAxB20[20 * 8] __attribute__((aligned(64))) = {0};

    int32_t A_v_aux[12 * 8] __attribute__((aligned(32))) = {0};
    int32_t A_v_aux1[12 * 8] __attribute__((aligned(32))) = {0};
    int32_t A_A_v_aux[6 * 8] __attribute__((aligned(32))) = {0};
    int32_t A_A_v_aux1[6 * 8] __attribute__((aligned(32))) = {0};

    int32_t B_v_aux[12 * 8] __attribute__((aligned(32))) = {0};
    int32_t B_v_aux1[12 * 8] __attribute__((aligned(32))) = {0};
    int32_t B_B_v_aux[6 * 8] __attribute__((aligned(32))) = {0};
    int32_t B_B_v_aux1[6 * 8] __attribute__((aligned(32))) = {0};
    int32_t C_v_aux[12 * 8] __attribute__((aligned(32))) = {0};
    int32_t C_v_aux1[12 * 8] __attribute__((aligned(32))) = {0};

    //
    // CONVERT INTO REPRESENTATION SUITABLE FOR KARATSUBA
    //
    int32_t v_a[128] __attribute__((aligned(32))) = {0}, v_b[128] __attribute__((aligned(32))) = {0};
    int32_t v_c[256] __attribute__((aligned(32))) = {0};

    convert4Karatsuba(v_a, a, 128);
    convert4Karatsuba(v_b, b, 128);

    add_2x_avx2_32_8(v_aux, v_a, v_b);

    add_2x_avx2_32_4(A_v_aux, v_a, v_b);

    add_2x_avx2_32_2(A_A_v_aux, v_a, v_b);
    interleave(mmrA10, v_a, &A_A_v_aux[2 * 8], &v_a[2 * 8], &v_a[2 * 8]);
    interleave(mmrB10, v_b, A_A_v_aux, &v_b[2 * 8], &v_b[2 * 8]);
    // memset(mmrAxB20, 0, sizeof(mmrAxB20));
    mult_interl(mmrAxB20, mmrA10, mmrB10);
    carryVertical64_avx2(mmrAxB20, 20, RADIX);
    deinterleave(mmrAxB20, v_c, A_A_v_aux1, &v_c[4 * 8], B_B_v_aux);
    sub_avx2_32_4(A_A_v_aux1, v_c, &v_c[4 * 8]);
    add_avx2_32_4(&v_c[2 * 8], &v_c[2 * 8], A_A_v_aux1);

    add_2x_avx2_32_4(B_v_aux, &v_aux[8 * 8], v_aux);

    add_2x_avx2_32_2(A_A_v_aux, &A_v_aux[4 * 8], A_v_aux);
    interleave(mmrA10, &A_v_aux[4 * 8], &A_A_v_aux[2 * 8], &A_v_aux[6 * 8], &B_v_aux[6 * 8]);
    interleave(mmrB10, A_v_aux, A_A_v_aux, &A_v_aux[2 * 8], &B_v_aux[2 * 8]);
    memset(mmrAxB20, 0, sizeof(mmrAxB20));
    mult_interl(mmrAxB20, mmrA10, mmrB10);
    carryVertical64_avx2(mmrAxB20, 20, RADIX);
    deinterleave(mmrAxB20, A_v_aux1, A_A_v_aux1, &A_v_aux1[4 * 8], &B_v_aux1[4 * 8]);
    sub_avx2_32_4(A_A_v_aux1, A_v_aux1, &A_v_aux1[4 * 8]);
    add_avx2_32_4(&A_v_aux1[2 * 8], &A_v_aux1[2 * 8], A_A_v_aux1);

    add_2x_avx2_32_2(B_B_v_aux, &B_v_aux[4 * 8], B_v_aux);

    add_2x_avx2_32_2(A_A_v_aux, &v_a[4 * 8], &v_b[4 * 8]);
    interleave(mmrA10, &v_a[4 * 8], &A_A_v_aux[2 * 8], &v_a[6 * 8], &B_B_v_aux[2 * 8]);
    interleave(mmrB10, &v_b[4 * 8], A_A_v_aux, &v_b[6 * 8], B_B_v_aux);
    memset(mmrAxB20, 0, sizeof(mmrAxB20));
    mult_interl(mmrAxB20, mmrA10, mmrB10);
    carryVertical64_avx2(mmrAxB20, 20, RADIX);
    deinterleave(mmrAxB20, &v_c[8 * 8], A_A_v_aux1, &v_c[12 * 8], B_B_v_aux1);
    sub_avx2_32_4(A_A_v_aux1, &v_c[8 * 8], &v_c[12 * 8]);
    add_avx2_32_4(&v_c[10 * 8], &v_c[10 * 8], A_A_v_aux1);

    sub_avx2_32_8(A_v_aux1, v_c, &v_c[8 * 8]);

    add_avx2_32_8(&v_c[4 * 8], &v_c[4 * 8], A_v_aux1);

    add_2x_avx2_32_2(A_A_v_aux, &v_aux[8 * 8], v_aux);

    interleave(mmrA10, &v_aux[8 * 8], &A_A_v_aux[2 * 8], &v_aux[10 * 8], &B_v_aux[4 * 8]);
    interleave(mmrB10, v_aux, A_A_v_aux, &v_aux[2 * 8], B_v_aux);
    memset(mmrAxB20, 0, sizeof(mmrAxB20));
    mult_interl(mmrAxB20, mmrA10, mmrB10);
    carryVertical64_avx2(mmrAxB20, 20, RADIX);
    deinterleave(mmrAxB20, v_aux1, A_A_v_aux1, &v_aux1[4 * 8], B_v_aux1);
    sub_avx2_32_4(A_A_v_aux1, v_aux1, &v_aux1[4 * 8]);
    add_avx2_32_4(&v_aux1[2 * 8], &v_aux1[2 * 8], A_A_v_aux1);

    sub_avx2_32_4(B_B_v_aux1, B_v_aux1, &B_v_aux1[4 * 8]);

    add_avx2_32_4(&B_v_aux1[2 * 8], &B_v_aux1[2 * 8], B_B_v_aux1);

    add_2x_avx2_32_2(B_B_v_aux, &v_a[12 * 8], &v_b[12 * 8]);

    add_2x_avx2_32_2(A_A_v_aux, &v_aux[12 * 8], &v_aux[4 * 8]);
    interleave(mmrA10, &v_aux[12 * 8], &A_A_v_aux[2 * 8], &v_aux[14 * 8], &B_B_v_aux[2 * 8]);
    interleave(mmrB10, &v_aux[4 * 8], A_A_v_aux, &v_aux[6 * 8], B_B_v_aux);
    memset(mmrAxB20, 0, sizeof(mmrAxB20));
    mult_interl(mmrAxB20, mmrA10, mmrB10);
    carryVertical64_avx2(mmrAxB20, 20, RADIX);
    deinterleave(mmrAxB20, &v_aux1[8 * 8], A_A_v_aux1, &v_aux1[12 * 8], B_B_v_aux1);
    sub_avx2_32_4(A_A_v_aux1, &v_aux1[8 * 8], &v_aux1[12 * 8]);
    add_avx2_32_4(&v_aux1[10 * 8], &v_aux1[10 * 8], A_A_v_aux1);

    sub_avx2_32_8(B_v_aux1, v_aux1, &v_aux1[8 * 8]);

    add_avx2_32_8(&v_aux1[4 * 8], &v_aux1[4 * 8], B_v_aux1);

    add_2x_avx2_32_4(C_v_aux, &v_a[8 * 8], &v_b[8 * 8]);

    add_2x_avx2_32_2(A_A_v_aux, &v_a[8 * 8], &v_b[8 * 8]);
    interleave(mmrA10, &v_a[8 * 8], &A_A_v_aux[2 * 8], &v_a[10 * 8], &v_a[12 * 8]);
    interleave(mmrB10, &v_b[8 * 8], A_A_v_aux, &v_b[10 * 8], &v_b[12 * 8]);
    memset(mmrAxB20, 0, sizeof(mmrAxB20));
    mult_interl(mmrAxB20, mmrA10, mmrB10);
    carryVertical64_avx2(mmrAxB20, 20, RADIX);
    deinterleave(mmrAxB20, &v_c[16 * 8], A_A_v_aux1, &v_c[20 * 8], &v_c[24 * 8]);
    sub_avx2_32_4(A_A_v_aux1, &v_c[16 * 8], &v_c[20 * 8]);
    add_avx2_32_4(&v_c[18 * 8], &v_c[18 * 8], A_A_v_aux1);

    add_2x_avx2_32_2(A_A_v_aux, &C_v_aux[4 * 8], C_v_aux);
    interleave(mmrA10, &C_v_aux[4 * 8], &A_A_v_aux[2 * 8], &C_v_aux[6 * 8], &v_a[14 * 8]);
    interleave(mmrB10, C_v_aux, A_A_v_aux, &C_v_aux[2 * 8], &v_b[14 * 8]);
    memset(mmrAxB20, 0, sizeof(mmrAxB20));
    mult_interl(mmrAxB20, mmrA10, mmrB10);
    carryVertical64_avx2(mmrAxB20, 20, RADIX);
    deinterleave(mmrAxB20, C_v_aux1, A_A_v_aux1, &C_v_aux1[4 * 8], &v_c[28 * 8]);
    sub_avx2_32_4(A_A_v_aux1, C_v_aux1, &C_v_aux1[4 * 8]);
    add_avx2_32_4(&C_v_aux1[2 * 8], &C_v_aux1[2 * 8], A_A_v_aux1);

    // add_2x_2x2_avx2(C_C_v_aux, &v_a[12], &v_b[12], 2);

    sub_avx2_32_4(B_B_v_aux1, &v_c[24 * 8], &v_c[28 * 8]);
    add_avx2_32_4(&v_c[26 * 8], &v_c[26 * 8], B_B_v_aux1);

    sub_avx2_32_8(C_v_aux1, &v_c[16 * 8], &v_c[24 * 8]);

    add_avx2_32_8(&v_c[20 * 8], &v_c[20 * 8], C_v_aux1);
    // +++++++++++++++++++++++++++++++++
    sub_avx2_32_16(v_aux1, v_c, &v_c[16 * 8]);

    add_avx2_32_16(&v_c[8 * 8], &v_c[8 * 8], v_aux1);

    //
    // CONVERT BACK
    //
    convertFromKarastuba(v_result, v_c, 256);
}

static inline void sqr_80x80_avx2_C(int32_t *v_result, const fp a, const fp b)
{
    // __m256i v_aux[24];
    int32_t v_aux[24 * 8] __attribute__((aligned(32))) = {0};
    int32_t v_aux1[24 * 8] __attribute__((aligned(32))) = {0};
    int32_t mmrA10[10 * 8] __attribute__((aligned(32))) = {0};
    int32_t mmrB10[10 * 8] __attribute__((aligned(32))) = {0};
    int64_t mmrAxB20[20 * 8] __attribute__((aligned(64))) = {0};

    int32_t A_v_aux[12 * 8] __attribute__((aligned(32))) = {0};
    int32_t A_v_aux1[12 * 8] __attribute__((aligned(32))) = {0};
    int32_t A_A_v_aux[6 * 8] __attribute__((aligned(32))) = {0};
    int32_t A_A_v_aux1[6 * 8] __attribute__((aligned(32))) = {0};

    int32_t B_v_aux[12 * 8] __attribute__((aligned(32))) = {0};
    int32_t B_v_aux1[12 * 8] __attribute__((aligned(32))) = {0};
    int32_t B_B_v_aux[6 * 8] __attribute__((aligned(32))) = {0};
    int32_t B_B_v_aux1[6 * 8] __attribute__((aligned(32))) = {0};
    int32_t C_v_aux[12 * 8] __attribute__((aligned(32))) = {0};
    int32_t C_v_aux1[12 * 8] __attribute__((aligned(32))) = {0};

    //
    // CONVERT INTO REPRESENTATION SUITABLE FOR KARATSUBA
    //
    int32_t v_a[128] __attribute__((aligned(32))) = {0}, v_b[128] __attribute__((aligned(32))) = {0};
    int32_t v_c[256] __attribute__((aligned(32))) = {0};

    convert4Karatsuba(v_a, a, 128);
    convert4Karatsuba(v_b, b, 128);

    add_2x_avx2_32_8(v_aux, v_a, v_b);

    add_2x_avx2_32_4(A_v_aux, v_a, v_b);

    add_2x_avx2_32_2(A_A_v_aux, v_a, v_b);
    interleave(mmrA10, v_a, &A_A_v_aux[2 * 8], &v_a[2 * 8], &v_a[2 * 8]);
    interleave(mmrB10, v_b, A_A_v_aux, &v_b[2 * 8], &v_b[2 * 8]);
    // memset(mmrAxB20, 0, sizeof(mmrAxB20));
    squaring_interl(mmrAxB20, mmrA10, mmrB10);
    carryVertical64_avx2(mmrAxB20, 20, RADIX);
    deinterleave(mmrAxB20, v_c, A_A_v_aux1, &v_c[4 * 8], B_B_v_aux);
    sub_avx2_32_4(A_A_v_aux1, v_c, &v_c[4 * 8]);
    add_avx2_32_4(&v_c[2 * 8], &v_c[2 * 8], A_A_v_aux1);

    add_2x_avx2_32_4(B_v_aux, &v_aux[8 * 8], v_aux);

    add_2x_avx2_32_2(A_A_v_aux, &A_v_aux[4 * 8], A_v_aux);
    interleave(mmrA10, &A_v_aux[4 * 8], &A_A_v_aux[2 * 8], &A_v_aux[6 * 8], &B_v_aux[6 * 8]);
    interleave(mmrB10, A_v_aux, A_A_v_aux, &A_v_aux[2 * 8], &B_v_aux[2 * 8]);
    memset(mmrAxB20, 0, sizeof(mmrAxB20));
    squaring_interl(mmrAxB20, mmrA10, mmrB10);
    carryVertical64_avx2(mmrAxB20, 20, RADIX);
    deinterleave(mmrAxB20, A_v_aux1, A_A_v_aux1, &A_v_aux1[4 * 8], &B_v_aux1[4 * 8]);
    sub_avx2_32_4(A_A_v_aux1, A_v_aux1, &A_v_aux1[4 * 8]);
    add_avx2_32_4(&A_v_aux1[2 * 8], &A_v_aux1[2 * 8], A_A_v_aux1);

    add_2x_avx2_32_2(B_B_v_aux, &B_v_aux[4 * 8], B_v_aux);

    add_2x_avx2_32_2(A_A_v_aux, &v_a[4 * 8], &v_b[4 * 8]);
    interleave(mmrA10, &v_a[4 * 8], &A_A_v_aux[2 * 8], &v_a[6 * 8], &B_B_v_aux[2 * 8]);
    interleave(mmrB10, &v_b[4 * 8], A_A_v_aux, &v_b[6 * 8], B_B_v_aux);
    memset(mmrAxB20, 0, sizeof(mmrAxB20));
    squaring_interl(mmrAxB20, mmrA10, mmrB10);
    carryVertical64_avx2(mmrAxB20, 20, RADIX);
    deinterleave(mmrAxB20, &v_c[8 * 8], A_A_v_aux1, &v_c[12 * 8], B_B_v_aux1);
    sub_avx2_32_4(A_A_v_aux1, &v_c[8 * 8], &v_c[12 * 8]);
    add_avx2_32_4(&v_c[10 * 8], &v_c[10 * 8], A_A_v_aux1);

    sub_avx2_32_8(A_v_aux1, v_c, &v_c[8 * 8]);

    add_avx2_32_8(&v_c[4 * 8], &v_c[4 * 8], A_v_aux1);

    add_2x_avx2_32_2(A_A_v_aux, &v_aux[8 * 8], v_aux);

    interleave(mmrA10, &v_aux[8 * 8], &A_A_v_aux[2 * 8], &v_aux[10 * 8], &B_v_aux[4 * 8]);
    interleave(mmrB10, v_aux, A_A_v_aux, &v_aux[2 * 8], B_v_aux);
    memset(mmrAxB20, 0, sizeof(mmrAxB20));
    squaring_interl(mmrAxB20, mmrA10, mmrB10);
    carryVertical64_avx2(mmrAxB20, 20, RADIX);
    deinterleave(mmrAxB20, v_aux1, A_A_v_aux1, &v_aux1[4 * 8], B_v_aux1);
    sub_avx2_32_4(A_A_v_aux1, v_aux1, &v_aux1[4 * 8]);
    add_avx2_32_4(&v_aux1[2 * 8], &v_aux1[2 * 8], A_A_v_aux1);

    sub_avx2_32_4(B_B_v_aux1, B_v_aux1, &B_v_aux1[4 * 8]);

    add_avx2_32_4(&B_v_aux1[2 * 8], &B_v_aux1[2 * 8], B_B_v_aux1);

    add_2x_avx2_32_2(B_B_v_aux, &v_a[12 * 8], &v_b[12 * 8]);

    add_2x_avx2_32_2(A_A_v_aux, &v_aux[12 * 8], &v_aux[4 * 8]);
    interleave(mmrA10, &v_aux[12 * 8], &A_A_v_aux[2 * 8], &v_aux[14 * 8], &B_B_v_aux[2 * 8]);
    interleave(mmrB10, &v_aux[4 * 8], A_A_v_aux, &v_aux[6 * 8], B_B_v_aux);
    memset(mmrAxB20, 0, sizeof(mmrAxB20));
    squaring_interl(mmrAxB20, mmrA10, mmrB10);
    carryVertical64_avx2(mmrAxB20, 20, RADIX);
    deinterleave(mmrAxB20, &v_aux1[8 * 8], A_A_v_aux1, &v_aux1[12 * 8], B_B_v_aux1);
    sub_avx2_32_4(A_A_v_aux1, &v_aux1[8 * 8], &v_aux1[12 * 8]);
    add_avx2_32_4(&v_aux1[10 * 8], &v_aux1[10 * 8], A_A_v_aux1);

    sub_avx2_32_8(B_v_aux1, v_aux1, &v_aux1[8 * 8]);

    add_avx2_32_8(&v_aux1[4 * 8], &v_aux1[4 * 8], B_v_aux1);

    add_2x_avx2_32_4(C_v_aux, &v_a[8 * 8], &v_b[8 * 8]);

    add_2x_avx2_32_2(A_A_v_aux, &v_a[8 * 8], &v_b[8 * 8]);
    interleave(mmrA10, &v_a[8 * 8], &A_A_v_aux[2 * 8], &v_a[10 * 8], &v_a[12 * 8]);
    interleave(mmrB10, &v_b[8 * 8], A_A_v_aux, &v_b[10 * 8], &v_b[12 * 8]);
    memset(mmrAxB20, 0, sizeof(mmrAxB20));
    squaring_interl(mmrAxB20, mmrA10, mmrB10);
    carryVertical64_avx2(mmrAxB20, 20, RADIX);
    deinterleave(mmrAxB20, &v_c[16 * 8], A_A_v_aux1, &v_c[20 * 8], &v_c[24 * 8]);
    sub_avx2_32_4(A_A_v_aux1, &v_c[16 * 8], &v_c[20 * 8]);
    add_avx2_32_4(&v_c[18 * 8], &v_c[18 * 8], A_A_v_aux1);

    add_2x_avx2_32_2(A_A_v_aux, &C_v_aux[4 * 8], C_v_aux);
    interleave(mmrA10, &C_v_aux[4 * 8], &A_A_v_aux[2 * 8], &C_v_aux[6 * 8], &v_a[14 * 8]);
    interleave(mmrB10, C_v_aux, A_A_v_aux, &C_v_aux[2 * 8], &v_b[14 * 8]);
    memset(mmrAxB20, 0, sizeof(mmrAxB20));
    squaring_interl(mmrAxB20, mmrA10, mmrB10);
    carryVertical64_avx2(mmrAxB20, 20, RADIX);
    deinterleave(mmrAxB20, C_v_aux1, A_A_v_aux1, &C_v_aux1[4 * 8], &v_c[28 * 8]);
    sub_avx2_32_4(A_A_v_aux1, C_v_aux1, &C_v_aux1[4 * 8]);
    add_avx2_32_4(&C_v_aux1[2 * 8], &C_v_aux1[2 * 8], A_A_v_aux1);

    // add_2x_2x2_avx2(C_C_v_aux, &v_a[12], &v_b[12], 2);

    sub_avx2_32_4(B_B_v_aux1, &v_c[24 * 8], &v_c[28 * 8]);
    add_avx2_32_4(&v_c[26 * 8], &v_c[26 * 8], B_B_v_aux1);

    sub_avx2_32_8(C_v_aux1, &v_c[16 * 8], &v_c[24 * 8]);

    add_avx2_32_8(&v_c[20 * 8], &v_c[20 * 8], C_v_aux1);
    // +++++++++++++++++++++++++++++++++
    sub_avx2_32_16(v_aux1, v_c, &v_c[16 * 8]);

    add_avx2_32_16(&v_c[8 * 8], &v_c[8 * 8], v_aux1);

    //
    // CONVERT BACK
    //
    convertFromKarastuba(v_result, v_c, 256);
}

/*
AVX2 STUFF ##########################
*/

// const fp fp_0 = {0x0};





void fp_cswap(fp x, fp y, uint8_t c)
{
    uint32_t tmp, c32;
    c32 = (uint32_t)-c;

    for (int i = 0; i < NUMBER_OF_LIMBS; i++)
    {
        tmp = (y[i] ^ x[i]) & c32;
        x[i] ^= tmp;
        y[i] ^= tmp;
    }
}



void fp_add(fp c, const fp a, const fp b)
{

    // fp test;
    // printf("add\n");
    // fflush(stdout);
    add_avx2(c, a, b);

    if(fp_issmaller(p, c))
        fp_sub(c, c, p);

    carry32_avx2(c, 10);

    CNT_FP_ADD_INC();
    count_add++;
}


void fp_sub(fp c, const fp a, const fp b)
{
    // printf("sub\n");
    // fflush(stdout);
    sub_avx2(c, a, b);
    if(fp_issmaller(c, fp_0))
        fp_add(c, c, p);    

    carry32_avx2(c, 10);        
    // int32_t carryover = 0;
    // carry32(c, NUMBER_OF_LIMBS, RADIX, &carryover);
    // carry32_avx2(c, 10);

    CNT_FP_ADD_INC();
}

void fp_mul_wo_redc(int32_t *c, const fp a, const fp b)
{
    mult_80x80_avx2_C(c, a, b);
}

/*
    see Algorithm 14.36 "Montgomery multiplication"
    https://cacr.uwaterloo.ca/hac/about/chap14.pdf
*/
void fp_mul(fp c, const fp a, const fp b)
{
    // printf("mul\n");
    // fflush(stdout);
    if ((count_add - count_add_old) > count_add_max)
    {
        count_add_max = count_add - count_add_old;
        //printf("%" PRIu64 "\n", count_add_max);
    }

    count_add_old = count_add;



    int32_t carryover = 0;

    int32_t result[160] __attribute__((aligned(32))) = {0};


    mult_80x80_avx2_C(result, a, b);


    int64_t tmp64[NUMBER_OF_LIMBS + 1] __attribute__((aligned(32))) = {0x0};
    int32_t tmp32[2 * NUMBER_OF_LIMBS] __attribute__((aligned(4))) = {0};


    for (int i = 0; i < NUMBER_OF_LIMBS; i++)
    {

        // uint32_t tmp = result[i];
        p_times_w(tmp64, p, result[0]);

        carryHorizontal(tmp32, tmp64, NUMBER_OF_LIMBS + 1, RADIX, &carryover);
        
        // TODO!!!
        // OneTimeCarry(tmp32, tmp64);

        a_plus_u_i(result, tmp32);

        // carry32(result, 2 * NUMBER_OF_LIMBS, RADIX, &carryover);  

        carry32_avx2(result, 20);
        // carry32_avx2(result, 20);  

        // carry for the next mul
        // int32_t carry = 0;
        // carry = (result[0] >> RADIX);
        // result[0] = (result[0] & ((1 << RADIX) - 1));
        // result[1] = result[1] + carry;
        // carry = (result[1] >> RADIX);
        // result[1] = (result[1] & ((1 << RADIX) - 1));
        // result[2] = result[2] + carry;

        memcpy(result, result + 1, sizeof(result) - sizeof(int32_t) );

    }

    // carry32(result, 80, RADIX, &carryover);

    memcpy(c, result, sizeof(fp));

    // if(fp_issmaller(c, p)==0)
    // {
    //     printf("smaller!\n");
    // }

    fp c_tmp;
    fp_sub(c_tmp, c, p);

    fp_cmov((fp *) c, (const fp*) c_tmp, fp_issmaller(c, p)==0);

    CNT_FP_MUL_INC();
}

void fp_sqr(fp c, const fp a)
{
    // printf("sqr\n");
    // fflush(stdout);
    int32_t carryover = 0;

    int32_t result[160] __attribute__((aligned(32))) = {0};


    sqr_80x80_avx2_C(result, a, a);


    int64_t tmp64[NUMBER_OF_LIMBS + 1] __attribute__((aligned(32))) = {0x0};
    int32_t tmp32[2 * NUMBER_OF_LIMBS] __attribute__((aligned(4))) = {0};


    for (int i = 0; i < NUMBER_OF_LIMBS; i++)
    {

        // uint32_t tmp = result[i];
        p_times_w(tmp64, p, result[0]);

        carryHorizontal(tmp32, tmp64, NUMBER_OF_LIMBS + 1, RADIX, &carryover);
        
        // TODO!!!
        // OneTimeCarry(tmp32, tmp64);

        a_plus_u_i(result, tmp32);

        // carry32(result, 2 * NUMBER_OF_LIMBS, RADIX, &carryover);    
        carry32_avx2(result, 20);   

        // carry for the next mul
        // int32_t carry = 0;
        // carry = (result[0] >> RADIX);
        // result[0] = (result[0] & ((1 << RADIX) - 1));
        // result[1] = result[1] + carry;
        // carry = (result[1] >> RADIX);
        // result[1] = (result[1] & ((1 << RADIX) - 1));
        // result[2] = result[2] + carry;

        memcpy(result, result + 1, sizeof(result) - sizeof(int32_t) );

    }

    // carry32(result, NUMBER_OF_LIMBS, RADIX, &carryover);
    // conv64toBase((uint32_t*) c, &c64[NUMBER_OF_WORDS], NUMBER_OF_WORDS, RADIX); 

    memcpy(c, result, sizeof(fp));

    // printf("smaller %d\n\n\n", fp_issmaller(c, p)==0);

    // fp c_tmp;
    // fp_sub(c_tmp, c, p);

    // fp_cmov((fp *) c, (const fp*) c_tmp, fp_issmaller(c, p)==0);

    CNT_FP_SQR_INC();
}

// void fp_copy(fp a, fp const b)
// {

//     for (int i = 0; i < NUMBER_OF_LIMBS; i++)
//     {
//         a[i] = b[i];
//     }

// }


void fp_random(fp x)
{
    // uint64_t x64[NUMBER_OF_WORDS] = {
    // 0xf084e45a62a402e1,0x5a6742ea249c5833,0x6a23f24aa2142339,0x297c255864ec1320,
    // 0x14148d253a4ce527,0xcbbb21d1b9380fe6,0x8669637113ef076b,0x83af439a5baaa5b7,
    // 0x82cd9f82936524,0x849bc296d8c2b819,0x555c2f750be49e4,0x3705b1f8aedacce2,
    // 0xb5d8acce19e4df02,0x7acc8160bca68daf,0xcede063a2a2afd35,0x6404facc6f0cae21,
    // 0xf403b630f9e3d753,0x6900d672336d0841,0x9e6779f0acdc2174,0x4eef267ff164ce4a,
    // 0xed3177d326bf33a0,0xf5b5375a82d89afa,0x6ba84ca9c6585882,0x4d4091ee5a721880,
    // 0xc00a747fdb0f4acf,0xdf1cc8d6f5a38200,0x74a5b9b7586a058a,0xef62a68e8ffd7737,
    // 0x607a5e419ecf5742,0x6d206881260e14a1,0x1d49dbc1737e80b0,0x3b8236f31ad322e3
    // };

    // convTomm256(x, x64, 16, 32, 80, 26);
    // fp_copy(x, fp_1);    
    uint64_t x64[NUMBER_OF_WORDS] = {0};
    while (1)
    {
        randombytes(x64, sizeof(x64));
        uint64_t m = ((uint64_t)1 << pbits % 64) - 1;
        x64[16 - 1] &= m;

        for (size_t i = NUMBER_OF_WORDS - 1; i < NUMBER_OF_WORDS; --i)
            if (x64[i] < p64[i])
            {

                // for (int j = 0; j < NUMBER_OF_WORDS; j=j+4)
                // {
                //     printf(".quad 0x%" PRIx64 ",", x64[j]);
                //     printf("0x%" PRIx64 ",", x64[j + 1]);
                //     printf("0x%" PRIx64 ",", x64[j + 2]);
                //     printf("0x%" PRIx64 "\n", x64[j + 3]);
                // }
                // convTomm256(x, x64, 16, 32, 80, 26);
                // convTomm256(x, x64, 16, 32, 80, 26);
                conv64toBase((uint32_t *)x, x64, NUMBER_OF_LIMBS, NUMBER_OF_WORDS, RADIX);
                return;
            }
            else if (x64[i] > p64[i])
                break;
    }
}
